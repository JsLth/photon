<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Local photon instance — photon_local • photon</title><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Local photon instance — photon_local"><meta name="description" content="This R6 class is used to initialize and manage local photon instances.
It can download and setup the Java, the photon executable, and the necessary
OpenSearch index. It can start, stop, and query the status of the
photon instance. It is also the basis for geocoding requests as it is used
to retrieve the URL for geocoding."><meta property="og:description" content="This R6 class is used to initialize and manage local photon instances.
It can download and setup the Java, the photon executable, and the necessary
OpenSearch index. It can start, stop, and query the status of the
photon instance. It is also the basis for geocoding requests as it is used
to retrieve the URL for geocoding."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.7.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/photon.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/nominatim-import.html"><span class="fa fa-database"></span> Import from Nominatim</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jslth/photon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Local photon instance</h1>
      <small class="dont-index">Source: <a href="https://github.com/jslth/photon/blob/v0.7.4/R/photon_local.R" class="external-link"><code>R/photon_local.R</code></a></small>
      <div class="d-none name"><code>photon_local.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This R6 class is used to initialize and manage local photon instances.
It can download and setup the Java, the photon executable, and the necessary
OpenSearch index. It can start, stop, and query the status of the
photon instance. It is also the basis for geocoding requests as it is used
to retrieve the URL for geocoding.</p>
    </div>


    <div class="section level2">
    <h2 id="search-indices">Search indices<a class="anchor" aria-label="anchor" href="#search-indices"></a></h2>


<p>Search indices can be self-provided by importing an existing
Nominatim database or they can be downloaded from the
<a href="https://nominatim.org/2020/10/21/photon-country-extracts.html" class="external-link">Photon download server</a>.
If you want to download pre-built search indices, simply provide a
<code>country</code> string during initialization or use the
<code>$download_data</code> method. Pre-built search indices do not come with
support for structured geocoding.</p>
<p>If you want to build from Nominatim, do not
provide a country string and use the <code>$import</code> method. See
<code><a href="../articles/nominatim-import.html">vignette("nominatim-import", package = "photon")</a></code> for details on how
to import from Nominatim.</p>
<p>To enable structured geocoding, the photon geocoder needs to be built to
support OpenSearch. Since photon 0.7.0, OpenSearch jar files are the
standard and ElasticSearch is deprecated.</p>
    </div>
    <div class="section level2">
    <h2 id="super-class">Super class<a class="anchor" aria-label="anchor" href="#super-class"></a></h2>
    <p><code><a href="photon-package.html">photon::photon</a></code> -&gt; <code>photon_local</code></p>
    </div>
    <div class="section level2">
    <h2 id="public-fields">Public fields<a class="anchor" aria-label="anchor" href="#public-fields"></a></h2>
    <p></p><div class="r6-fields"><dl><dt><code>path</code></dt>
<dd><p>Path to the directory where the photon instance is stored.</p></dd>


<dt><code>proc</code></dt>
<dd><p><code><a href="http://processx.r-lib.org/reference/process.html" class="external-link">process</a></code> object that handles the
external process running photon.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-photon_local-new"><code>photon_local$new()</code></a></p></li>
<li><p><a href="#method-photon_local-mount"><code>photon_local$mount()</code></a></p></li>
<li><p><a href="#method-photon_local-info"><code>photon_local$info()</code></a></p></li>
<li><p><a href="#method-photon_local-help"><code>photon_local$help()</code></a></p></li>
<li><p><a href="#method-photon_local-purge"><code>photon_local$purge()</code></a></p></li>
<li><p><a href="#method-photon_local-import"><code>photon_local$import()</code></a></p></li>
<li><p><a href="#method-photon_local-start"><code>photon_local$start()</code></a></p></li>
<li><p><a href="#method-photon_local-stop"><code>photon_local$stop()</code></a></p></li>
<li><p><a href="#method-photon_local-download_data"><code>photon_local$download_data()</code></a></p></li>
<li><p><a href="#method-photon_local-remove_data"><code>photon_local$remove_data()</code></a></p></li>
<li><p><a href="#method-photon_local-is_running"><code>photon_local$is_running()</code></a></p></li>
<li><p><a href="#method-photon_local-is_ready"><code>photon_local$is_ready()</code></a></p></li>
<li><p><a href="#method-photon_local-get_url"><code>photon_local$get_url()</code></a></p></li>
<li><p><a href="#method-photon_local-get_logs"><code>photon_local$get_logs()</code></a></p></li>
<li><p><a href="#method-photon_local-clone"><code>photon_local$clone()</code></a></p></li>
</ul></div><p></p><hr><a id="method-photon_local-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Initialize a local photon instance. If necessary, downloads the photon
executable, the search index, and Java.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/photon_local.html">photon_local</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">path</span>,</span>
<span>  photon_version <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  country <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  section <span class="op">=</span> <span class="st">"experimental"</span>,</span>
<span>  opensearch <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  mount <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>path</code></dt>
<dd><p>Path to a directory where the photon executable and data
should be stored.</p></dd>


<dt><code>photon_version</code></dt>
<dd><p>Version of photon to be used. A list of all
releases can be found here: <a href="https://github.com/komoot/photon/releases/" class="external-link">https://github.com/komoot/photon/releases/</a>.
Ignored if <code>jar</code> is given. If <code>NULL</code>, uses the latest known
version (Currently: 0.7.4).</p></dd>


<dt><code>country</code></dt>
<dd><p>Character string that can be identified by
<code><a href="https://vincentarelbundock.github.io/countrycode/reference/countryname.html" class="external-link">countryname</a></code> as a country. An extract for this
country will be downloaded. If <code>"planet"</code>, downloads a global search
index.</p></dd>


<dt><code>date</code></dt>
<dd><p>Character string or date-time object used to specify the creation
date of the search index. If <code>"latest"</code>, will download the file tagged
with "latest". If a character string, the value should be parseable by
<code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>. If <code>exact = FALSE</code>, the input value is
compared to all available dates and the closest date will be selected.
Otherwise, a file will be selected that exactly matches the input to
<code>date</code>.</p></dd>


<dt><code>exact</code></dt>
<dd><p>If <code>TRUE</code>, exactly matches the <code>date</code>. Otherwise,
selects the date with lowest difference to the <code>date</code> parameter.</p></dd>


<dt><code>section</code></dt>
<dd><p>Subdirectory of the download server from which to select a
search index. If <code>"experimental"</code>, selects a dump made for the master
version of photon. If <code>"archived"</code>, selects a dump made for an older
version of photon. If <code>NULL</code> (or any arbitrary string), selects a
dump made for the current release. Defaults to <code>NULL</code>.</p></dd>


<dt><code>opensearch</code></dt>
<dd><p>Superseded for photon versions &gt;= 0.7.0. If <code>TRUE</code>,
attempts to download the OpenSearch version of photon. OpenSearch-based
photon supports structrued geocoding. Readily available OpenSearch
photon executables are only offered since photon version 0.6.0. For
earlier versions, you need to build from source using gradle. In this
case, if <code>TRUE</code>, will look for an OpenSearch version of photon in
the specified path. Since photon version 0.7.0, OpenSearch is the
recommended option. Defaults to <code>TRUE</code>.</p></dd>


<dt><code>mount</code></dt>
<dd><p>If <code>TRUE</code>, mounts the object to the session so that
functions like <code><a href="geocode.html">geocode</a></code> automatically detect the new
instance. If <code>FALSE</code>, initializies the instance but doesn't mount
it to the session. Defaults to <code>TRUE</code>.</p></dd>


<dt><code>overwrite</code></dt>
<dd><p>If <code>TRUE</code>, overwrites existing jar files and
search indices when initializing a new instance. Defaults to
<code>FALSE</code>.</p></dd>


<dt><code>quiet</code></dt>
<dd><p>If <code>TRUE</code>, suppresses all informative messages.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-photon_local-mount"></a><div class="section">
<h3 id="method-mount-">Method <code>mount()</code><a class="anchor" aria-label="anchor" href="#method-mount-"></a></h3>
<p>Attach the object to the session. If mounted, all geocoding functions
send their requests to the URL of this instance. Manually mounting
is useful if you want to switch between multiple photon instances.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">mount</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-photon_local-info"></a><div class="section">
<h3 id="method-info-">Method <code>info()</code><a class="anchor" aria-label="anchor" href="#method-info-"></a></h3>
<p>Retrieve metadata about the java and photon version used as well
as the country and creation date of the search index.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">info</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p>A list containing the java version, the photon version, and
if applicable, the spatial and temporal coverage of the search index.</p>
</div>

</div><p></p><hr><a id="method-photon_local-help"></a><div class="section">
<h3 id="method-help-">Method <code><a href="https://rdrr.io/r/utils/help.html" class="external-link">help()</a></code><a class="anchor" aria-label="anchor" href="#method-help-"></a></h3>
<p>Print the default arguments to the R console. This can be helpful to
get a list of additional photon arguments for <code>$start()</code> or
<code>$import()</code>.</p><div class="section">
<h4 id="usage-3">Usage<a class="anchor" aria-label="anchor" href="#usage-3"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">help</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-1">Returns<a class="anchor" aria-label="anchor" href="#returns-1"></a></h4>
<p>Nothing, but prints to the console.</p>
</div>

</div><p></p><hr><a id="method-photon_local-purge"></a><div class="section">
<h3 id="method-purge-">Method <code>purge()</code><a class="anchor" aria-label="anchor" href="#method-purge-"></a></h3>
<p>Kill the photon process and remove the directory. Useful to get rid
of an instance entirely.</p><div class="section">
<h4 id="usage-4">Usage<a class="anchor" aria-label="anchor" href="#usage-4"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">purge</span><span class="op">(</span>ask <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>ask</code></dt>
<dd><p>If <code>TRUE</code>, asks for confirmation before purging the
instance.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns-2">Returns<a class="anchor" aria-label="anchor" href="#returns-2"></a></h4>
<p><code>NULL</code>, invisibly.</p>
</div>

</div><p></p><hr><a id="method-photon_local-import"></a><div class="section">
<h3 id="method-import-">Method <code>import()</code><a class="anchor" aria-label="anchor" href="#method-import-"></a></h3>
<p>Import a Postgres Nominatim database to photon. Runs the photon jar
file using the additional parameter <code>-nominatim-import</code>. Requires
a running Nominatim database that can be connected to.</p><div class="section">
<h4 id="usage-5">Usage<a class="anchor" aria-label="anchor" href="#usage-5"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">import</span><span class="op">(</span></span>
<span>  host <span class="op">=</span> <span class="st">"127.0.0.1"</span>,</span>
<span>  port <span class="op">=</span> <span class="fl">5432</span>,</span>
<span>  database <span class="op">=</span> <span class="st">"nominatim"</span>,</span>
<span>  user <span class="op">=</span> <span class="st">"nominatim"</span>,</span>
<span>  password <span class="op">=</span> <span class="st">""</span>,</span>
<span>  structured <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  update <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  enable_update_api <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  languages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"en"</span>, <span class="st">"fr"</span>, <span class="st">"de"</span>, <span class="st">"it"</span><span class="op">)</span>,</span>
<span>  countries <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  extra_tags <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  json <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  java_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  photon_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>host</code></dt>
<dd><p>Postgres host of the database. Defaults to <code>"127.0.0.1"</code>.</p></dd>


<dt><code>port</code></dt>
<dd><p>Postgres port of the database. Defaults to <code>5432</code>.</p></dd>


<dt><code>database</code></dt>
<dd><p>Postgres database name. Defaults to <code>"nominatim"</code>.</p></dd>


<dt><code>user</code></dt>
<dd><p>Postgres database user. Defaults to <code>"nominatim"</code>.</p></dd>


<dt><code>password</code></dt>
<dd><p>Postgres database password. Defaults to <code>""</code>.</p></dd>


<dt><code>structured</code></dt>
<dd><p>If <code>TRUE</code>, enables structured query support when
importing the database. This allows the usage of
<code><a href="structured.html">structured</a></code>. Structured queries are only supported in the
OpenSearch version of photon. See section "OpenSearch" above. Defaults
to <code>FALSE</code>.</p></dd>


<dt><code>update</code></dt>
<dd><p>If <code>TRUE</code>, fetches updates from the Nominatim database,
updating the search index without offering an API. If <code>FALSE</code>,
imports the database an deletes the previous index. Defaults to
<code>FALSE</code>.</p></dd>


<dt><code>enable_update_api</code></dt>
<dd><p>If <code>TRUE</code>, enables an additional
endpoint <code>/nominatim-update</code>, which allows updates from
Nominatim databases.</p></dd>


<dt><code>languages</code></dt>
<dd><p>Character vector specifying the languages to import
from the Nominatim databases. Defaults to English, French, German,
and Italian.</p></dd>


<dt><code>countries</code></dt>
<dd><p>Character vector specifying the country codes to
import from the Nominatim database. Defaults to all country codes.</p></dd>


<dt><code>extra_tags</code></dt>
<dd><p>Character vector specifying extra OSM tags to import
from the Nominatim database. These tags are used to augment geocoding
results. Defaults to <code>NULL</code>.</p></dd>


<dt><code>json</code></dt>
<dd><p>If <code>TRUE</code>, dumps the imported Nominatim database to
a JSON file and returns the path to the output file. Defaults to
<code>FALSE</code>.</p></dd>


<dt><code>timeout</code></dt>
<dd><p>Time in seconds before the java process aborts. Defaults
to 60 seconds.</p></dd>


<dt><code>java_opts</code></dt>
<dd><p>Character vector of further flags passed on to the
<code>java</code> command.</p></dd>


<dt><code>photon_opts</code></dt>
<dd><p>Character vector of further flags passed on to the
photon jar in the java command. See <code><a href="cmd_options.html">cmd_options</a></code> for a
helper function.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-photon_local-start"></a><div class="section">
<h3 id="method-start-">Method <code><a href="https://rdrr.io/r/stats/start.html" class="external-link">start()</a></code><a class="anchor" aria-label="anchor" href="#method-start-"></a></h3>
<p>Start a local instance of the Photon geocoder. Runs the jar executable
located in the instance directory.</p><div class="section">
<h4 id="usage-6">Usage<a class="anchor" aria-label="anchor" href="#usage-6"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">start</span><span class="op">(</span></span>
<span>  host <span class="op">=</span> <span class="st">"0.0.0.0"</span>,</span>
<span>  port <span class="op">=</span> <span class="st">"2322"</span>,</span>
<span>  ssl <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  timeout <span class="op">=</span> <span class="fl">60</span>,</span>
<span>  java_opts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  photon_opts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-3">Arguments<a class="anchor" aria-label="anchor" href="#arguments-3"></a></h4>
<p></p><div class="arguments"><dl><dt><code>host</code></dt>
<dd><p>Character string of the host name that the geocoder should
be opened on.</p></dd>


<dt><code>port</code></dt>
<dd><p>Port that the geocoder should listen to.</p></dd>


<dt><code>ssl</code></dt>
<dd><p>If <code>TRUE</code>, uses <code>https</code>, otherwise <code>http</code>.
Defaults to <code>FALSE</code>.</p></dd>


<dt><code>timeout</code></dt>
<dd><p>Time in seconds before the java process aborts. Defaults
to 60 seconds.</p></dd>


<dt><code>java_opts</code></dt>
<dd><p>Character vector of further flags passed on to the
<code>java</code> command.</p></dd>


<dt><code>photon_opts</code></dt>
<dd><p>Character vector of further flags passed on to the
photon jar in the java command. See <code><a href="cmd_options.html">cmd_options</a></code> for a
helper function.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h4>
<p>While there is a certain way to determine if a photon instance is
ready, there is no clear way as of yet to determine if a photon setup
has failed. Due to this, a failing setup may sometimes hang instead of
emitting an error. In this case, please open a bug report.</p>
</div>


</div><p></p><hr><a id="method-photon_local-stop"></a><div class="section">
<h3 id="method-stop-">Method <code><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop()</a></code><a class="anchor" aria-label="anchor" href="#method-stop-"></a></h3>
<p>Kills the running photon process.</p><div class="section">
<h4 id="usage-7">Usage<a class="anchor" aria-label="anchor" href="#usage-7"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-photon_local-download_data"></a><div class="section">
<h3 id="method-download-data-">Method <code>download_data()</code><a class="anchor" aria-label="anchor" href="#method-download-data-"></a></h3>
<p>Downloads a search index using <code><a href="download_searchindex.html">download_searchindex</a></code>.</p><div class="section">
<h4 id="usage-8">Usage<a class="anchor" aria-label="anchor" href="#usage-8"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">download_data</span><span class="op">(</span></span>
<span>  <span class="va">country</span>,</span>
<span>  date <span class="op">=</span> <span class="st">"latest"</span>,</span>
<span>  exact <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  section <span class="op">=</span> <span class="st">"experimental"</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-4">Arguments<a class="anchor" aria-label="anchor" href="#arguments-4"></a></h4>
<p></p><div class="arguments"><dl><dt><code>country</code></dt>
<dd><p>Character string that can be identified by
<code><a href="https://vincentarelbundock.github.io/countrycode/reference/countryname.html" class="external-link">countryname</a></code> as a country. An extract for this
country will be downloaded. If <code>"planet"</code>, downloads a global search
index.</p></dd>


<dt><code>date</code></dt>
<dd><p>Character string or date-time object used to specify the creation
date of the search index. If <code>"latest"</code>, will download the file tagged
with "latest". If a character string, the value should be parseable by
<code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></code>. If <code>exact = FALSE</code>, the input value is
compared to all available dates and the closest date will be selected.
Otherwise, a file will be selected that exactly matches the input to
<code>date</code>.</p></dd>


<dt><code>exact</code></dt>
<dd><p>If <code>TRUE</code>, exactly matches the <code>date</code>. Otherwise,
selects the date with lowest difference to the <code>date</code> parameter.</p></dd>


<dt><code>section</code></dt>
<dd><p>Subdirectory of the download server from which to select a
search index. If <code>"experimental"</code>, selects a dump made for the master
version of photon. If <code>"archived"</code>, selects a dump made for an older
version of photon. If <code>NULL</code> (or any arbitrary string), selects a
dump made for the current release. Defaults to <code>NULL</code>.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-photon_local-remove_data"></a><div class="section">
<h3 id="method-remove-data-">Method <code>remove_data()</code><a class="anchor" aria-label="anchor" href="#method-remove-data-"></a></h3>
<p>Removes the data currently used in the photon directory. This only
affects the unpacked <code>photon_data</code> directory, not archived files.</p><div class="section">
<h4 id="usage-9">Usage<a class="anchor" aria-label="anchor" href="#usage-9"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">remove_data</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>


</div><p></p><hr><a id="method-photon_local-is_running"></a><div class="section">
<h3 id="method-is-running-">Method <code>is_running()</code><a class="anchor" aria-label="anchor" href="#method-is-running-"></a></h3>
<p>Checks whether the photon instance is running and ready. The difference
to <code>$is_ready()</code> is that <code>$is_running()</code> checks specifically
if the running photon instance is managed by a process from its own
<code>photon</code> object. In other words, <code>$is_running()</code> returns
<code>TRUE</code> if both <code>$proc$is_alive()</code> and <code>$is_ready()</code>
return <code>TRUE</code>. This method is useful if you want to ensure that
the <code>photon</code> object can control its photon server (mostly internal
use).</p><div class="section">
<h4 id="usage-10">Usage<a class="anchor" aria-label="anchor" href="#usage-10"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">is_running</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-3">Returns<a class="anchor" aria-label="anchor" href="#returns-3"></a></h4>
<p>A logical of length 1.</p>
</div>

</div><p></p><hr><a id="method-photon_local-is_ready"></a><div class="section">
<h3 id="method-is-ready-">Method <code>is_ready()</code><a class="anchor" aria-label="anchor" href="#method-is-ready-"></a></h3>
<p>Checks whether the photon instance is ready to take requests. This
is the case if the photon server returns a HTTP 400 when sending a
queryless request. This method is useful if you want to check whether
you can send requests.</p><div class="section">
<h4 id="usage-11">Usage<a class="anchor" aria-label="anchor" href="#usage-11"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">is_ready</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-4">Returns<a class="anchor" aria-label="anchor" href="#returns-4"></a></h4>
<p>A logical of length 1.</p>
</div>

</div><p></p><hr><a id="method-photon_local-get_url"></a><div class="section">
<h3 id="method-get-url-">Method <code>get_url()</code><a class="anchor" aria-label="anchor" href="#method-get-url-"></a></h3>
<p>Constructs the URL that geocoding requests should be sent to.</p><div class="section">
<h4 id="usage-12">Usage<a class="anchor" aria-label="anchor" href="#usage-12"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">get_url</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-5">Returns<a class="anchor" aria-label="anchor" href="#returns-5"></a></h4>
<p>A URL to send requests to.</p>
</div>

</div><p></p><hr><a id="method-photon_local-get_logs"></a><div class="section">
<h3 id="method-get-logs-">Method <code>get_logs()</code><a class="anchor" aria-label="anchor" href="#method-get-logs-"></a></h3>
<p>Retrieve the logs of previous photon runs.</p><div class="section">
<h4 id="usage-13">Usage<a class="anchor" aria-label="anchor" href="#usage-13"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">get_logs</span><span class="op">(</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="returns-6">Returns<a class="anchor" aria-label="anchor" href="#returns-6"></a></h4>
<p>Returns a dataframe containing the run ID (<code>rid</code>, the
highest number is the most recent run), a timestamp (<code>ts</code>), the
thread, the log type (INFO, WARN, or ERROR), the class trace and the
error message.</p>
</div>

</div><p></p><hr><a id="method-photon_local-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-14">Usage<a class="anchor" aria-label="anchor" href="#usage-14"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">photon_local</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-5">Arguments<a class="anchor" aria-label="anchor" href="#arguments-5"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="has_java.html">has_java</a></span><span class="op">(</span><span class="st">"11"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">dir</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"photon"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># start a new instance using a Monaco extract</span></span></span>
<span class="r-in"><span><span class="va">photon</span> <span class="op">&lt;-</span> <span class="fu"><a href="new_photon.html">new_photon</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">dir</span>, country <span class="op">=</span> <span class="st">"Monaco"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># start a new instance with an older photon version</span></span></span>
<span class="r-in"><span><span class="va">photon</span> <span class="op">&lt;-</span> <span class="fu"><a href="new_photon.html">new_photon</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">dir</span>, photon_version <span class="op">=</span> <span class="st">"0.4.1"</span>, opensearch <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> openjdk version "17.0.16" 2025-07-15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> OpenJDK Runtime Environment Temurin-17.0.16+8 (build 17.0.16+8)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> OpenJDK 64-Bit Server VM Temurin-17.0.16+8 (build 17.0.16+8, mixed mode,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   sharing)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Fetching OpenSearch photon <span style="color: #00BB00;">0.7.4</span>.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Successfully downloaded OpenSearch photon <span style="color: #00BB00;">0.7.4</span>. <span style="color: #B2B2B2;">[789ms]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Fetching search index for <span style="color: #00BB00;">Monaco</span>, created on <span style="color: #00BB00;">latest</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Successfully downloaded search index. <span style="color: #B2B2B2;">[880ms]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Version: 0.7.4</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Coverage: Monaco</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Time: 2025-10-31</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> openjdk version "17.0.16" 2025-07-15</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> OpenJDK Runtime Environment Temurin-17.0.16+8 (build 17.0.16+8)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> OpenJDK 64-Bit Server VM Temurin-17.0.16+8 (build 17.0.16+8, mixed mode,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   sharing)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Fetching ElasticSearch photon <span style="color: #00BB00;">0.4.1</span>.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BB00;">✔</span> Successfully downloaded ElasticSearch photon <span style="color: #00BB00;">0.4.1</span>. <span style="color: #B2B2B2;">[471ms]</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> A search index already exists at the given path. Download will be skipped</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Version: 0.4.1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Coverage: Monaco</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> • Time: 2025-10-31</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># import a nominatim database using OpenSearch photon</span></span></span>
<span class="r-in"><span><span class="co"># this example requires the OpenSearch version of photon and a running</span></span></span>
<span class="r-in"><span><span class="co"># Nominatim server.</span></span></span>
<span class="r-in"><span><span class="va">photon</span> <span class="op">&lt;-</span> <span class="fu"><a href="new_photon.html">new_photon</a></span><span class="op">(</span>path <span class="op">=</span> <span class="va">dir</span>, opensearch <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">photon</span><span class="op">$</span><span class="fu">import</span><span class="op">(</span>photon_options <span class="op">=</span> <span class="fu"><a href="cmd_options.html">cmd_options</a></span><span class="op">(</span>port <span class="op">=</span> <span class="fl">29146</span>, password <span class="op">=</span> <span class="st">"pgpass"</span><span class="op">)</span><span class="op">)</span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">photon</span><span class="op">$</span><span class="fu">purge</span><span class="op">(</span>ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

