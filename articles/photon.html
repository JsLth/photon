<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to {photon} • photon</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to {photon}">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">photon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span> Overview</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/photon.html"><span class="fa fa-book"></span> Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/nominatim-import.html"><span class="fa fa-database"></span> Import from Nominatim</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-search"></span> Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jslth/photon/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to {photon}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jslth/photon/blob/main/vignettes/photon.Rmd" class="external-link"><code>vignettes/photon.Rmd</code></a></small>
      <div class="d-none name"><code>photon.Rmd</code></div>
    </div>

    
    
<p>This vignette is an introduction to the <a href="https://github.com/jslth/photon/" class="external-link">photon</a>
package, an interface to the <a href="https://photon.komoot.io/" class="external-link">photon</a> geocoder developed by <a href="https://www.komoot.com/" class="external-link">komoot</a>. Photon is open-source, based
on <a href="https://www.openstreetmap.org/" class="external-link">OpenStreetMap</a> data, and
powered by the <a href="https://www.elastic.co/elasticsearch" class="external-link">ElasticSearch</a> search
engine. It is – according to komoot – fast, scalable, multilingual,
typo-tolerant, and up-to-date. Photon can do unstructured geocoding,
reverse geocoding, and (under special circumstances) structured
geocoding. Komoot offers a public photon API (<a href="https://photon.komoot.io/" class="external-link uri">https://photon.komoot.io/</a>) but you can also set up a
photon instance on a local machine.</p>
<p><a href="https://github.com/jslth/photon/" class="external-link">photon</a> supports both online and offline geocoding.
Online geocoding through komoots public API is intriguing because it is
convenient and offers up-to-date global coverage. It is appropriately
easy to use online geocoding in <a href="https://github.com/jslth/photon/" class="external-link">photon</a>. First, it is
necessary to tell R that you want to use the public API. This can be
done using the workhorse function <code><a href="../reference/new_photon.html">new_photon()</a></code>. To set up
online geocoding, simply call it without parameters:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/new_photon.html">new_photon</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; &lt;photon&gt;</span></span>
<span><span class="co">#&gt;   Type   : remote</span></span>
<span><span class="co">#&gt;   Server : https://photon.komoot.io/</span></span></code></pre></div>
<p>The created <code>photon</code> object is attached to the session and
does not have to be stored manually. Now you can geocode.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocode.html">geocode</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sanaa"</span>, <span class="st">"Caracas"</span><span class="op">)</span>, osm_tag <span class="op">=</span> <span class="st">":city"</span><span class="op">)</span></span>
<span><span class="va">cities1</span></span>
<span><span class="co">#&gt; Simple feature collection with 2 features and 12 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -66.9146 ymin: 10.50609 xmax: 44.20588 ymax: 15.35386</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 13</span></span>
<span><span class="co">#&gt;     idx osm_type    osm_id osm_key osm_value type   countrycode name  country state county extent            geometry</span></span>
<span><span class="co">#&gt;   &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;list&gt;         &lt;POINT [°]&gt;</span></span>
<span><span class="co">#&gt; 1     1 N        258013552 place   city      distr… YE          Sana… Yemen   Aman… At Ta… &lt;lgl&gt;  (44.20588 15.35386)</span></span>
<span><span class="co">#&gt; 2     2 R         11219583 place   city      city   VE          Cara… Venezu… Capi… Munic… &lt;dbl&gt;  (-66.9146 10.50609)</span></span></code></pre></div>
<p>Similarly, you can also reverse geocode. <a href="https://github.com/jslth/photon/" class="external-link">photon</a> fully
supports <code>sf</code> objects so that all geocoding functions return
<code>sf</code> dataframes and <code><a href="../reference/reverse.html">reverse()</a></code> accepts
<code>sf</code> and <code>sfc</code> objects as input.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cities2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reverse.html">reverse</a></span><span class="op">(</span><span class="va">cities1</span>, osm_tag <span class="op">=</span> <span class="st">":city"</span><span class="op">)</span></span>
<span><span class="va">cities2</span></span>
<span><span class="co">#&gt; Simple feature collection with 2 features and 12 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -66.9146 ymin: 10.50609 xmax: 44.20588 ymax: 15.35386</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 13</span></span>
<span><span class="co">#&gt;    idx osm_type    osm_id osm_key osm_value type   countrycode name  country state county extent            geometry</span></span>
<span><span class="co">#&gt;  &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt;  &lt;chr&gt;       &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;  &lt;list&gt;         &lt;POINT [°]&gt;</span></span>
<span><span class="co">#&gt;1     1 N        258013552 place   city      distr… YE          Sana… Yemen   Aman… At Ta… &lt;lgl&gt;  (44.20588 15.35386)</span></span>
<span><span class="co">#&gt;2     2 R         11219583 place   city      city   VE          Cara… Venezu… Capi… Munic… &lt;dbl&gt;  (-66.9146 10.50609) </span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">cities1</span>, <span class="va">cities2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>More recently, the photon geocoder started to support structured
geocoding. Structured geocoding works just like <code><a href="../reference/geocode.html">geocode()</a></code>,
but you provide place data in a dataframe instead of a character string.
This allows you to be much more specific in what you want to geocode.
While you’d have to fiddle with location biases to geocode Moscow, MN,
structured geocoding can be a little more precise.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">place</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  city <span class="op">=</span> <span class="st">"Moscow"</span>,</span>
<span>  state <span class="op">=</span> <span class="st">"Minnesota"</span>,</span>
<span>  countrycode <span class="op">=</span> <span class="st">"USA"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/structured.html">structured</a></span><span class="op">(</span><span class="va">place</span><span class="op">)</span></span>
<span><span class="co">#&gt; Simple feature collection with 1 feature and 12 fields</span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -93.09825 ymin: 43.70718 xmax: -93.09825 ymax: 43.70718</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 13</span></span></span>
<span><span class="co">#&gt;     idx osm_type   osm_id osm_key osm_value type  countrycode name  county state</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 R        19<span style="text-decoration: underline;">843</span>371 place   village   city  US          Mosc… Freeb… Minn…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 3 more variables: country &lt;chr&gt;, extent &lt;list&gt;, geometry &lt;POINT [°]&gt;</span></span></span></code></pre></div>
<p>Online geocoding is nice and it is most likely what you need for
basic tasks. But what if online geocoding is not enough? What if you
need to geocode a dataset of 200,000 places? What if you need to geocode
sensitive information from survey respondents? And what about structured
geocoding?</p>
<div class="section level2">
<h2 id="offline-geocoding">Offline geocoding<a class="anchor" aria-label="anchor" href="#offline-geocoding"></a>
</h2>
<p>The photon backend is freely available on the <a href="https://github.com/komoot/photon" class="external-link">photon GitHub repository</a>.
With it, you can set up a local instance of photon. Offline geocoding is
nice because it is extremely fast, versatile and it doesn’t send your
potentially sensitive data around the internet. In a lot of cases,
offline geocoding is absolutely imperative, yet usually, setting up an
offline geocoder can be quite cumbersome. <a href="https://github.com/jslth/photon/" class="external-link">photon</a> takes
over this task!</p>
<p>To run photon, you need the Java Development Kit (JDK) version 11 or
higher. To do that, you can use the <a href="https://cran.r-project.org/package=rJavaEnv" class="external-link"><code>{rJavaEnv}</code></a>
package by Egor Kotov. It allows you to easily set up a JDK environment
for a local project.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># pak::pkg_install("rJavaEnv")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/e-kotov/rJavaEnv" class="external-link">rJavaEnv</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Consent to downloading Java</span></span>
<span><span class="fu">rje_consent</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Consent for using rJavaEnv has already been provided.</span></span>
<span></span>
<span><span class="co"># Install and use Corretto JDK 24</span></span>
<span><span class="fu">use_java</span><span class="op">(</span><span class="fl">24</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check if installation was successful</span></span>
<span><span class="fu">java_check_version_cmd</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; JAVA_HOME: /root/.cache/R/rJavaEnv/installed/linux/x64/24</span></span>
<span><span class="co">#&gt; Java path: /root/.cache/R/rJavaEnv/installed/linux/x64/24/bin/java</span></span>
<span><span class="co">#&gt; Java version: "openjdk version \"24.0.1\" 2025-04-15 OpenJDK Runtime Environment Corretto-24.0.1.9.1 (build</span></span>
<span><span class="co">#&gt; 24.0.1+9-FR) OpenJDK 64-Bit Server VM Corretto-24.0.1.9.1 (build 24.0.1+9-FR, mixed mode, sharing)"</span></span>
<span><span class="co">#&gt; [1] "24"</span></span></code></pre></div>
<p>Setting up local photon also works through <code><a href="../reference/new_photon.html">new_photon()</a></code>.
This time, we pass a path where the necessary files should be stored and
a country for which a search index should be downloaded. While global
coverage is also possible, the global search index is extremely large
(around 80 GB). By default, <code><a href="../reference/new_photon.html">new_photon()</a></code> downloads a search
index tagged with <code>latest</code> but it is also possible to query a
search index created at a specific date.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, <span class="st">"photon"</span><span class="op">)</span></span>
<span><span class="va">photon</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_photon.html">new_photon</a></span><span class="op">(</span><span class="va">path</span>, region <span class="op">=</span> <span class="st">"Andorra"</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ openjdk version "24.0.1" 2025-04-15</span></span>
<span><span class="co">#&gt; ℹ OpenJDK Runtime Environment Corretto-24.0.1.9.1 (build 24.0.1+9-FR)</span></span>
<span><span class="co">#&gt; ℹ OpenJDK 64-Bit Server VM Corretto-24.0.1.9.1 (build 24.0.1+9-FR, mixed mode, sharing)</span></span>
<span><span class="co">#&gt; ✔ Successfully downloaded OpenSearch photon 1.0.0. [17.9s]</span></span>
<span><span class="co">#&gt; ✔ Successfully downloaded search index. [854ms]</span></span>
<span><span class="co">#&gt; • Version: 1.0.0</span></span>
<span><span class="co">#&gt; • Coverage: Andorra</span></span>
<span><span class="co">#&gt; • Time: 2026-02-27</span></span></code></pre></div>
<p>The resulting object is an R6 class with a few methods to control the
instance. To start photon, run <code>$start()</code>. This starts an
external java process which can be accessed using the <code>$proc</code>
attribute.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#&gt; photon$start()</span></span>
<span><span class="co">#&gt; Cluster Name: photon </span></span>
<span><span class="co">#&gt; Base Path:    /tmp/RtmpLQIqmy/photon/./photon_data</span></span>
<span><span class="co">#&gt; Num Of Node:  1      </span></span>
<span><span class="co">#&gt; Node Name:      Node 1</span></span>
<span><span class="co">#&gt; HTTP Port:      9201 </span></span>
<span><span class="co">#&gt; Data Directory: /tmp/RtmpLQIqmy/photon/./photon_data/node_1/data</span></span>
<span><span class="co">#&gt; Log Directory:  /tmp/RtmpLQIqmy/photon/./photon_data/node_1/logs</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,384][INFO ][o.o.n.Node               ] version[3.4.0], pid[19752], build[unknown/unknown/unknown], OS[Windows 11/10.0/amd64], JVM[Oracle Corporation/Java HotSpot(TM) 64-Bit Server VM/22/22+36-2370]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,385][INFO ][o.o.n.Node               ] JVM home [/root/.cache/R/rJavaEnv/installed/linux/x64/24]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,389][INFO ][o.o.n.Node               ] JVM arguments []</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,395][INFO ][o.o.p.PluginsService     ] no modules loaded</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,396][INFO ][o.o.p.PluginsService     ] loaded plugin [org.opensearch.analysis.common.CommonAnalysisModulePlugin]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,397][INFO ][o.o.p.PluginsService     ] loaded plugin [org.opensearch.geo.GeoModulePlugin]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,397][INFO ][o.o.p.PluginsService     ] loaded plugin [org.opensearch.transport.Netty4ModulePlugin]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,438][INFO ][o.o.e.NodeEnvironment    ] using [1] data paths, mounts [[/ (/dev/sdd)]], net usable_space [103.5gb], net total_space [783.6gb], types [NTFS]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,443][INFO ][o.o.e.NodeEnvironment    ] heap size [3.9gb], compressed ordinary object pointers [true]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,536][WARN ][o.a.l.i.v.VectorizationProvider] Java vector incubator module is not readable. For optimal vector performance, pass '--add-modules jdk.incubator.vector' to enable Vector API.</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,624][INFO ][o.o.n.Node               ] node name [Node 1], node ID [FYcghCrFQyi8ZcOrpZkWmA], cluster name [photon], roles [data, cluster_manager]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,664][INFO ][o.o.e.ExtensionsManager  ] ExtensionsManager initialized</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,911][INFO ][o.o.i.MergeSchedulerConfig] Updating autoThrottle for index _na_ from [false] to [true]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,911][INFO ][o.o.i.MergeSchedulerConfig] Updating maxThreadCount from [0] to [4] and maxMergeCount from [0] to [9] for index _na_.</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:54,911][INFO ][o.o.i.MergeSchedulerConfig] Initialized index _na_ with maxMergeCount=9, maxThreadCount=4, autoThrottleEnabled=true</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:55,087][INFO ][o.o.i.MergeSchedulerConfig] Updating autoThrottle for index _na_ from [false] to [true]</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:55,087][INFO ][o.o.i.MergeSchedulerConfig] Updating maxThreadCount from [0] to [4] and maxMergeCount from [0] to [9] for index _na_.</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:55,087][INFO ][o.o.i.MergeSchedulerConfig] Initialized index _na_ with maxMergeCount=9, maxThreadCount=4, autoThrottleEnabled=true</span></span>
<span><span class="co">#&gt; [2026-02-27T14:29:56,578][INFO ][o.o.t.NettyAllocator     ] creating NettyAllocator with the following configs: [name=opensearch_configured, chunk_size=512kb, suggested_max_allocation_size=512kb, factors={opensearch.unsafe.use_netty_default_chunk_and_page_size=false, g1gc_enabled=true, g1gc_region_size=2mb}]</span></span>
<span><span class="co">#&gt; ✔ Photon is now running. [6.2s]</span></span>
<span></span>
<span><span class="va">photon</span><span class="op">$</span><span class="va">proc</span></span>
<span><span class="co">#&gt; PROCESS 'java', running, pid 1896.</span></span></code></pre></div>
<p>To check if the service is up and running, you can use
<code>$is_ready()</code>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">photon</span><span class="op">$</span><span class="fu">is_ready</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>To compare offline and online geocoding, let’s benchmark them by
geocoding the Samoan capital Apia:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># offline geocoding</span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu">mark</span><span class="op">(</span><span class="fu"><a href="../reference/with_photon.html">with_photon</a></span><span class="op">(</span><span class="va">photon</span>, <span class="fu"><a href="../reference/geocode.html">geocode</a></span><span class="op">(</span><span class="st">"Monte Carlo"</span><span class="op">)</span><span class="op">)</span>, iterations <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">$</span><span class="va">median</span></span>
<span><span class="co">#&gt; [1] 30.2ms</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># online geocoding</span></span>
<span><span class="va">photon_pub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/new_photon.html">new_photon</a></span><span class="op">(</span>mount <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu">bench</span><span class="fu">::</span><span class="fu">mark</span><span class="op">(</span><span class="fu"><a href="../reference/with_photon.html">with_photon</a></span><span class="op">(</span><span class="va">photon_pub</span>, <span class="fu"><a href="../reference/geocode.html">geocode</a></span><span class="op">(</span><span class="st">"Monte Carlo"</span><span class="op">)</span><span class="op">)</span>, iterations <span class="op">=</span> <span class="fl">25</span><span class="op">)</span><span class="op">$</span><span class="va">median</span></span>
<span><span class="co">#&gt; [1] 334ms</span></span></code></pre></div>
<p>That is a speed increase by a factor of over 10 (and possibly more on
faster machines)!</p>
<p>To properly stop photon after you used it, you can run
<code>$stop()</code>. You do not actually <em>need</em> to run it
manually, because it is (implicitly) executed on two occasions: 1. on
garbage collection and 2. when the R session ends and external processes
are killed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">photon</span><span class="op">$</span><span class="kw">stop</span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Finally, to clean up photon, i.e. stop the instance and delete the
photon directory, run <code>$purge()</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">photon</span><span class="op">$</span><span class="fu">purge</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; ℹ Purging an instance kills the photon process and removes the photon directory.</span></span>
<span><span class="co">#&gt; Continue? (y/N/Cancel) y</span></span></code></pre></div>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jonas Lieth.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
