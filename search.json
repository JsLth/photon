[{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to photon","title":"Contributing to photon","text":"outlines propose change photon. detailed discussion contributing tidyverse packages, please see development contributing guide code review principles.","code":""},{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":"fixing-typos","dir":"","previous_headings":"","what":"Fixing typos","title":"Contributing to photon","text":"can fix typos, spelling mistakes, grammatical errors documentation directly using GitHub web interface, long changes made source file. generally means ’ll need edit roxygen2 comments .R, .Rd file. can find .R file generates .Rd reading comment first line.","code":""},{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":"bigger-changes","dir":"","previous_headings":"","what":"Bigger changes","title":"Contributing to photon","text":"want make bigger change, ’s good idea first file issue make sure someone team agrees ’s needed. ’ve found bug, please file issue illustrates bug minimal reprex (also help write unit test, needed). See guide create great issue advice.","code":""},{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":"pull-request-process","dir":"","previous_headings":"Bigger changes","what":"Pull request process","title":"Contributing to photon","text":"Fork package clone onto computer. haven’t done , recommend using usethis::create_from_github(\"JsLth/photon\", fork = TRUE). Install development dependencies devtools::install_dev_deps(), make sure package passes R CMD check running devtools::check(). R CMD check doesn’t pass cleanly, ’s good idea ask help continuing. Create Git branch pull request (PR). recommend using usethis::pr_init(\"brief-description--change\"). Make changes, commit git, create PR running usethis::pr_push(), following prompts browser. title PR briefly describe change. body PR contain Fixes #issue-number. user-facing changes, add bullet top NEWS.md (.e. just first header). Follow style described https://style.tidyverse.org/news.html.","code":""},{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":"code-style","dir":"","previous_headings":"Bigger changes","what":"Code style","title":"Contributing to photon","text":"New code follow tidyverse style guide. can use styler package apply styles, please don’t restyle code nothing PR. use roxygen2 documentation. use testthat unit tests. Contributions test cases included easier accept.","code":""},{"path":"https://jslth.github.io/photon/CONTRIBUTING.html","id":"thanks-for-contributing","dir":"","previous_headings":"","what":"Thanks for contributing!","title":"Contributing to photon","text":"contributing guide adapted tidyverse contributing guide available https://raw.githubusercontent.com/r-lib/usethis/master/inst/templates/tidy-contributing.md","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"Apache License","title":"Apache License","text":"Version 2.0, January 2004 <http://www.apache.org/licenses/>","code":""},{"path":[]},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_1-definitions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"1. Definitions","title":"Apache License","text":"“License” shall mean terms conditions use, reproduction, distribution defined Sections 1 9 document. “Licensor” shall mean copyright owner entity authorized copyright owner granting License. “Legal Entity” shall mean union acting entity entities control, controlled , common control entity. purposes definition, “control” means () power, direct indirect, cause direction management entity, whether contract otherwise, (ii) ownership fifty percent (50%) outstanding shares, (iii) beneficial ownership entity. “” (“”) shall mean individual Legal Entity exercising permissions granted License. “Source” form shall mean preferred form making modifications, including limited software source code, documentation source, configuration files. “Object” form shall mean form resulting mechanical transformation translation Source form, including limited compiled object code, generated documentation, conversions media types. “Work” shall mean work authorship, whether Source Object form, made available License, indicated copyright notice included attached work (example provided Appendix ). “Derivative Works” shall mean work, whether Source Object form, based (derived ) Work editorial revisions, annotations, elaborations, modifications represent, whole, original work authorship. purposes License, Derivative Works shall include works remain separable , merely link (bind name) interfaces , Work Derivative Works thereof. “Contribution” shall mean work authorship, including original version Work modifications additions Work Derivative Works thereof, intentionally submitted Licensor inclusion Work copyright owner individual Legal Entity authorized submit behalf copyright owner. purposes definition, “submitted” means form electronic, verbal, written communication sent Licensor representatives, including limited communication electronic mailing lists, source code control systems, issue tracking systems managed , behalf , Licensor purpose discussing improving Work, excluding communication conspicuously marked otherwise designated writing copyright owner “Contribution.” “Contributor” shall mean Licensor individual Legal Entity behalf Contribution received Licensor subsequently incorporated within Work.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_2-grant-of-copyright-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"2. Grant of Copyright License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable copyright license reproduce, prepare Derivative Works , publicly display, publicly perform, sublicense, distribute Work Derivative Works Source Object form.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_3-grant-of-patent-license","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"3. Grant of Patent License","title":"Apache License","text":"Subject terms conditions License, Contributor hereby grants perpetual, worldwide, non-exclusive, -charge, royalty-free, irrevocable (except stated section) patent license make, made, use, offer sell, sell, import, otherwise transfer Work, license applies patent claims licensable Contributor necessarily infringed Contribution(s) alone combination Contribution(s) Work Contribution(s) submitted. institute patent litigation entity (including cross-claim counterclaim lawsuit) alleging Work Contribution incorporated within Work constitutes direct contributory patent infringement, patent licenses granted License Work shall terminate date litigation filed.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_4-redistribution","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"4. Redistribution","title":"Apache License","text":"may reproduce distribute copies Work Derivative Works thereof medium, without modifications, Source Object form, provided meet following conditions: () must give recipients Work Derivative Works copy License; (b) must cause modified files carry prominent notices stating changed files; (c) must retain, Source form Derivative Works distribute, copyright, patent, trademark, attribution notices Source form Work, excluding notices pertain part Derivative Works; (d) Work includes “NOTICE” text file part distribution, Derivative Works distribute must include readable copy attribution notices contained within NOTICE file, excluding notices pertain part Derivative Works, least one following places: within NOTICE text file distributed part Derivative Works; within Source form documentation, provided along Derivative Works; , within display generated Derivative Works, wherever third-party notices normally appear. contents NOTICE file informational purposes modify License. may add attribution notices within Derivative Works distribute, alongside addendum NOTICE text Work, provided additional attribution notices construed modifying License. may add copyright statement modifications may provide additional different license terms conditions use, reproduction, distribution modifications, Derivative Works whole, provided use, reproduction, distribution Work otherwise complies conditions stated License.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_5-submission-of-contributions","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"5. Submission of Contributions","title":"Apache License","text":"Unless explicitly state otherwise, Contribution intentionally submitted inclusion Work Licensor shall terms conditions License, without additional terms conditions. Notwithstanding , nothing herein shall supersede modify terms separate license agreement may executed Licensor regarding Contributions.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_6-trademarks","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"6. Trademarks","title":"Apache License","text":"License grant permission use trade names, trademarks, service marks, product names Licensor, except required reasonable customary use describing origin Work reproducing content NOTICE file.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_7-disclaimer-of-warranty","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"7. Disclaimer of Warranty","title":"Apache License","text":"Unless required applicable law agreed writing, Licensor provides Work (Contributor provides Contributions) “” BASIS, WITHOUT WARRANTIES CONDITIONS KIND, either express implied, including, without limitation, warranties conditions TITLE, NON-INFRINGEMENT, MERCHANTABILITY, FITNESS PARTICULAR PURPOSE. solely responsible determining appropriateness using redistributing Work assume risks associated exercise permissions License.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_8-limitation-of-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"8. Limitation of Liability","title":"Apache License","text":"event legal theory, whether tort (including negligence), contract, otherwise, unless required applicable law (deliberate grossly negligent acts) agreed writing, shall Contributor liable damages, including direct, indirect, special, incidental, consequential damages character arising result License use inability use Work (including limited damages loss goodwill, work stoppage, computer failure malfunction, commercial damages losses), even Contributor advised possibility damages.","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"id_9-accepting-warranty-or-additional-liability","dir":"","previous_headings":"Terms and Conditions for use, reproduction, and distribution","what":"9. Accepting Warranty or Additional Liability","title":"Apache License","text":"redistributing Work Derivative Works thereof, may choose offer, charge fee , acceptance support, warranty, indemnity, liability obligations /rights consistent License. However, accepting obligations, may act behalf sole responsibility, behalf Contributor, agree indemnify, defend, hold Contributor harmless liability incurred , claims asserted , Contributor reason accepting warranty additional liability. END TERMS CONDITIONS","code":""},{"path":"https://jslth.github.io/photon/LICENSE.html","id":"appendix-how-to-apply-the-apache-license-to-your-work","dir":"","previous_headings":"","what":"APPENDIX: How to apply the Apache License to your work","title":"Apache License","text":"apply Apache License work, attach following boilerplate notice, fields enclosed brackets [] replaced identifying information. (Don’t include brackets!) text enclosed appropriate comment syntax file format. also recommend file class name description purpose included “printed page” copyright notice easier identification within third-party archives.","code":"Copyright [yyyy] [name of copyright owner]  Licensed under the Apache License, Version 2.0 (the \"License\"); you may not use this file except in compliance with the License. You may obtain a copy of the License at    http://www.apache.org/licenses/LICENSE-2.0  Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing permissions and limitations under the License."},{"path":"https://jslth.github.io/photon/articles/nominatim-import.html","id":"opensearch","dir":"Articles","previous_headings":"","what":"OpenSearch","title":"Importing a database from Nominatim","text":"Previous setups photon based ElasticSearch search engine. Photon also offers version based OpenSearch. photon version necessary enable structured geocoding queries. Since photon 0.6.0, OpenSearch jar files provided new photon releases can downloaded setting opensearch = TRUE new_photon() function. , $import() method created directory photon_data, 10-20% larger ElasticSearch version. starting photon, can verify structured geocoding enabled running has_structured_support(). Since structured geocoding now works, can now send entire datasets structured address data. Structured geocoding allows search specific elements address instead passing free text queries. following example, search three different spatial features querying state, street, housenumber. Photon able geocode high precision due detailed data structure provide.","code":"# set opensearch = TRUE to use OpenSearch photon photon <- new_photon(dir, opensearch = TRUE, quiet = TRUE)  # set structured = TRUE to enable structured geocoding photon$import(host = \"localhost\", password = \"MNdtC2*pP#aMbe\", structured = TRUE) photon$start() has_structured_support() #> [1] TRUE place_data <- data.frame(   housenumber = c(NA, \"77C\", NA),   street = c(\"Falealilli Cross Island Road\", \"Main Beach Road\", \"Le Mafa Pass Road\"),   state = c(\"Tuamasaga\", \"Tuamasaga\", \"Atua\") )  structured(place_data, limit = 1) #> Simple feature collection with 3 features and 14 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -171.7759 ymin: -14.04544 xmax: -171.451 ymax: -13.8338 #> Geodetic CRS:  WGS 84 #> # A tibble: 3 × 15 #>     idx osm_type    osm_id country osm_key  city      countrycode osm_value name    state type  extent housenumber street #>   <int> <chr>        <int> <chr>   <chr>    <chr>     <chr>       <chr>     <chr>   <chr> <chr> <list> <chr>       <chr>  #> 1     1 W        319147189 Samoa   highway  Siumu Uta WS          primary   Faleal… Tuam… stre… <dbl>  NA          NA     #> 2     2 W        569855981 Samoa   building Apia      WS          yes       NA      Tuam… house <dbl>  77C         Main … #> 3     3 W         40681149 Samoa   highway  Lalomanu  WS          primary   Main S… Ātua  stre… <dbl>  NA          NA     #> # ℹ 1 more variable: geometry <POINT [°]>"},{"path":"https://jslth.github.io/photon/articles/photon.html","id":"offline-geocoding","dir":"Articles","previous_headings":"","what":"Offline geocoding","title":"Introduction to {photon}","text":"photon backend freely available photon GitHub repository. , can set local instance photon. Offline geocoding nice extremely fast, versatile doesn’t send potentially sensitive data around internet. lot cases, offline geocoding absolutely imperative, yet usually, setting offline geocoder can quite cumbersome. photon takes task! run photon, need Java 11 higher. Setting local photon also works new_photon(). time, pass path necessary files stored country search index downloaded. global coverage also possible, global search index extremely large (around 80 GB). default, new_photon() downloads search index tagged latest also possible query search index created specific date. resulting object R6 class methods control instance. start photon, run $start(). starts external java process can accessed using $proc attribute. check service running, can use $is_ready(). Finally, properly stop photon used , can run $stop(). actually need run manually, (implicitly) executed two occasions: 1. garbage collection 2. R session ends external processes killed. compare offline online geocoding, let’s benchmark geocoding Samoan capital Apia: speed increase factor almost 60 (possibly faster machines)! Finally, clean photon, .e. stop instance delete photon directory, run $purge().","code":"path <- file.path(tempdir(), \"photon\") photon <- new_photon(path, country = \"Samoa\") #> ℹ java version \"22\" 2024-03-19 #> ℹ Java(TM) SE Runtime Environment (build 22+36-2370) #> ℹ Java HotSpot(TM) 64-Bit Server VM (build 22+36-2370, mixed mode, sharing) #> ✔ Successfully downloaded photon 0.5.0. [7s]           #> ✔ Successfully downloaded search index. [590ms]   #> • Version: 0.5.0 #> • Coverage: Samoa #> • Time: latest photon$start() #> Running java -jar photon-0.5.0.jar -listen-ip 0.0.0.0 -listen-port 2322 #> 2024-10-25 17:04:26,912 [main] WARN  org.elasticsearch.node.Node - version [5.6.16-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable for production #> ✔ Photon is now running. [11s]  photon$proc #> PROCESS 'java', running, pid 22744. photon$is_ready() #> [1] TRUE photon$stop() # offline geocoding bench::mark(geocode(\"Apai\", limit = 1), iterations = 25)$median #> [1] 17.1ms # online geocoding new_photon() bench::mark(geocode(\"Apai\", limit = 1), iterations = 25)$median #> [1] 1.05s photon$purge() #> ℹ Purging an instance kills the photon process and removes the photon directory. #> Continue? (y/N/Cancel) y"},{"path":"https://jslth.github.io/photon/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Jonas Lieth. Author, maintainer, copyright holder.","code":""},{"path":"https://jslth.github.io/photon/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lieth J (2025). photon: High-Performance Geocoding using 'photon'. R package version 0.3.5, https://jslth.github.io/photon/, https://github.com/jslth/photon/.","code":"@Manual{,   title = {photon: High-Performance Geocoding using 'photon'},   author = {Jonas Lieth},   year = {2025},   note = {R package version 0.3.5, https://jslth.github.io/photon/},   url = {https://github.com/jslth/photon/}, }"},{"path":"https://jslth.github.io/photon/index.html","id":"photon","dir":"","previous_headings":"","what":"High-Performance Geocoding using photon","title":"High-Performance Geocoding using photon","text":"photon simple interface setup manager photon OpenStreetMap geocoder. features unstructured, structured, reverse geocoding. package allows requests public API shines setting local instances enable high-performance offline geocoding.","code":""},{"path":"https://jslth.github.io/photon/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"High-Performance Geocoding using photon","text":"install package CRAN: can install development version photon GitHub :","code":"install.packages(\"photon\") # install.packages(\"remotes\") remotes::install_github(\"jslth/photon\")"},{"path":"https://jslth.github.io/photon/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"High-Performance Geocoding using photon","text":"loading photon, package assumes want send geocoding requests public photon API. want change , can use workhorse function new_photon(). Otherwise, can directly start geocoding. Reverse geocoding means taking point geometries returning addresses place names.","code":"library(photon) places <- c(\"Paris\", \"Beijing\", \"Sao Paolo\", \"Kinshasa\")  cities1 <- geocode(places, limit = 1, layer = \"city\") cities1 #> Simple feature collection with 4 features and 12 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -46.63338 ymin: -23.55065 xmax: 110.7344 ymax: 48.8535 #> Geodetic CRS:  WGS 84 #> # A tibble: 4 × 13 #>     idx osm_type  osm_id country osm_key countrycode osm_value name  state type  #>   <int> <chr>      <dbl> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <chr> #> 1     1 R         7.15e4 France  place   FR          city      Paris Ile-… city  #> 2     2 N         4.52e9 China   place   CN          town      Beij… Shan… city  #> 3     3 R         2.98e5 Brazil  place   BR          municipa… São … São … city  #> 4     4 R         3.88e5 Democr… bounda… CD          administ… Kins… Kins… city  #> # ℹ 3 more variables: extent <list>, county <chr>, geometry <POINT [°]> cities2 <- reverse(cities1$geometry, limit = 1, layer = \"city\") cities2 #> Simple feature collection with 4 features and 12 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -46.63338 ymin: -23.55065 xmax: 110.7344 ymax: 48.8535 #> Geodetic CRS:  WGS 84 #> # A tibble: 4 × 13 #>     idx osm_type  osm_id country osm_key countrycode osm_value name  state type  #>   <int> <chr>      <dbl> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <chr> #> 1     1 R         7.15e4 France  place   FR          city      Paris Ile-… city  #> 2     2 N         4.52e9 China   place   CN          town      Beij… Shan… city  #> 3     3 R         2.98e5 Brazil  place   BR          municipa… São … São … city  #> 4     4 R         3.88e5 Democr… bounda… CD          administ… Kins… Kins… city  #> # ℹ 3 more variables: extent <list>, county <chr>, geometry <POINT [°]> all.equal(cities1, cities2) #> [1] TRUE"},{"path":"https://jslth.github.io/photon/index.html","id":"offline-geocoding","dir":"","previous_headings":"","what":"Offline geocoding","title":"High-Performance Geocoding using photon","text":"photon designed facilitate offline geocoding. new_photon() can install photon locally. following code install start photon covering country Germany current working directory.","code":"photon <- new_photon(path = \"./photon\", country = \"Germany\") photon$start()"},{"path":"https://jslth.github.io/photon/index.html","id":"related-packages","dir":"","previous_headings":"","what":"Related packages","title":"High-Performance Geocoding using photon","text":"{photon} package Timothée Giraud interfaces photon allow setup local instances abandoned ago. {revgeo} package Michael Hudecheck implements reverse geocoding using (among others) photon. {tidygeocoder} {nominatimlite} packages implement general (OSM) geocoding using web APIs.","code":""},{"path":"https://jslth.github.io/photon/reference/cmd_options.html","id":null,"dir":"Reference","previous_headings":"","what":"Format command line options — cmd_options","title":"Format command line options — cmd_options","text":"Helper function format options command line calls. function accepts key-value pairs parameter name name option parameter value value option. Arguments formatted according following rules: value TRUE, add parameter name flag. value FALSE, add parameter name flag. value length(x) > 1, collapse CSV. parameter name missing, take value flag name. parameter name given, replace underscores hyphens.","code":""},{"path":"https://jslth.github.io/photon/reference/cmd_options.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Format command line options — cmd_options","text":"","code":"cmd_options(..., use_double_hyphens = FALSE)"},{"path":"https://jslth.github.io/photon/reference/cmd_options.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Format command line options — cmd_options","text":"... Key-value pairs command line options. use_double_hyphens TRUE, uses double hyphens designate non-abbreviated command line options single-hyphens designate abbreviated ones. FALSE, always uses single hyphens. Defaults FALSE Java photon use single hyphens.","code":""},{"path":"https://jslth.github.io/photon/reference/cmd_options.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Format command line options — cmd_options","text":"character vector formatted command line options can used input system2 run.","code":""},{"path":"https://jslth.github.io/photon/reference/cmd_options.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Format command line options — cmd_options","text":"","code":"# converts R parameters to CMD options # parameters for the ping command cmd_options(n = 1, w = 5, \"127.0.0.1\") #> [1] \"-n\"        \"1\"         \"-w\"        \"5\"         \"127.0.0.1\"  # sometimes, it is necessary to use double hyphens # options for the docker ps command cmd_options(\"ps\", all = TRUE, format = \"json\", use_double_hyphens = TRUE) #> [1] \"ps\"       \"--all\"    \"--format\" \"json\"      # particularly useful together with photon # the following options can be used for the `photon_opts` argument # of photon$start() cmd_options(cors_any = TRUE, data_dir = \"path/to/dir\") #> [1] \"-cors-any\"   \"-data-dir\"   \"path/to/dir\""},{"path":"https://jslth.github.io/photon/reference/download_photon.html","id":null,"dir":"Reference","previous_headings":"","what":"Download photon — download_photon","title":"Download photon — download_photon","text":"Download photon executable GitHub.","code":""},{"path":"https://jslth.github.io/photon/reference/download_photon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download photon — download_photon","text":"","code":"download_photon(   path = \".\",   version = NULL,   opensearch = FALSE,   only_url = FALSE,   quiet = FALSE )"},{"path":"https://jslth.github.io/photon/reference/download_photon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download photon — download_photon","text":"path Path directory store executable. version Version tag photon release. NULL, downloads latest known version. list releases can found : https://github.com/komoot/photon/releases/. Ignored jar given. NULL, uses latest known version (Currently: 0.6.2). opensearch TRUE, downloads OpenSearch version photon available. OpenSearch versions available photon >= 0.6.0. only_url TRUE, performs download. Otherwise, returns link file. quiet TRUE, suppresses informative messages.","code":""},{"path":"https://jslth.github.io/photon/reference/download_photon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download photon — download_photon","text":"only_url = FALSE, returns character string giving path downloaded file. Otherwise, returns URL downloaded.","code":""},{"path":"https://jslth.github.io/photon/reference/download_photon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download photon — download_photon","text":"","code":"download_photon(tempdir(), version = \"0.4.1\") #> ℹ Fetching photon 0.4.1. #> ✔ Successfully downloaded photon 0.4.1. [308ms] #>  #> [1] \"/tmp/Rtmp6wM48e/photon-0.4.1.jar\""},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":null,"dir":"Reference","previous_headings":"","what":"Download search index — download_searchindex","title":"Download search index — download_searchindex","text":"Finds downloads Elasticsearch index database necessary set Photon locally.","code":""},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Download search index — download_searchindex","text":"","code":"download_searchindex(   path = \".\",   country = \"Monaco\",   date = \"latest\",   exact = FALSE,   section = NULL,   only_url = FALSE,   quiet = FALSE )"},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Download search index — download_searchindex","text":"path Path directory identified file stored. country Character string can identified countryname country. extract country downloaded. \"planet\", downloads global search index. date Character string date-time object used specify creation date search index. \"latest\", download file tagged \"latest\". character string, value parseable .POSIXct. exact = FALSE, input value compared available dates closest date selected. Otherwise, file selected exactly matches input date. exact TRUE, exactly matches date. Otherwise, selects date lowest difference date parameter. section Subdirectory download server select search index. \"experimental\", selects dump made master version photon. \"archived\", selects dump made older version photon. NULL (arbitrary string), selects dump made current release. Defaults NULL. only_url TRUE, performs download. Otherwise, returns link file. quiet TRUE, suppresses informative messages.","code":""},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Download search index — download_searchindex","text":"only_url = FALSE, returns local path downloaded file. Otherwise, returns URL remote file.","code":""},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":"note","dir":"Reference","previous_headings":"","what":"Note","title":"Download search index — download_searchindex","text":"Depending country, search index databases tend large. global search index 75 GB size (10/2024). Keep mind running function.","code":""},{"path":"https://jslth.github.io/photon/reference/download_searchindex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Download search index — download_searchindex","text":"","code":"# download the latest extract of Monaco download_searchindex(path = tempdir()) #> ℹ Fetching search index for Monaco, created on latest #> ✔ Successfully downloaded search index. [1.5s] #>  #> [1] \"/tmp/Rtmp6wM48e/photon-db-mc-latest.tar.bz2\"  # download the latest extract of American Samoa download_searchindex(path = tempdir(), country = \"Samoa\") #> ℹ Fetching search index for Samoa, created on latest #> ✔ Successfully downloaded search index. [145ms] #>  #> [1] \"/tmp/Rtmp6wM48e/photon-db-ws-latest.tar.bz2\"  # download an extract from a month ago download_searchindex(   path = tempdir(),   country = \"Monaco\",   date = Sys.time() - 2629800  ) #> ℹ Fetching search index for Monaco, created on 2025-02-16 #> ✔ Successfully downloaded search index. [149ms] #>  #> [1] \"/tmp/Rtmp6wM48e/photon-db-mc-250216.tar.bz2\"  # if possible, download an extract from today try(download_searchindex(   path = tempdir(),   country = \"Monaco\",   date = Sys.Date(),   exact = TRUE )) #> Error in download_searchindex(path = tempdir(), country = \"Monaco\", date = Sys.Date(),  :  #>   ! Specified `date` does not match any available dates. #> ℹ Consider setting `exact = FALSE`.  # get the latest global coverage # NOTE: the file to be downloaded is several tens of gigabytes of size! if (FALSE) { # \\dontrun{ download_searchindex(path = tempdir(), country = \"planet\")} # }"},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":null,"dir":"Reference","previous_headings":"","what":"Unstructured geocoding — geocode","title":"Unstructured geocoding — geocode","text":"Geocode arbitrary text strings. Unstructured geocoding flexible generally less accurate structured geocoding.","code":""},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Unstructured geocoding — geocode","text":"","code":"geocode(   texts,   limit = 1,   lang = \"en\",   bbox = NULL,   osm_tag = NULL,   layer = NULL,   locbias = NULL,   locbias_scale = NULL,   zoom = NULL,   latinize = TRUE,   progress = interactive() )"},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Unstructured geocoding — geocode","text":"texts Character vector texts geocode. limit Number results return. maximum 50 results can returned single search term. Defaults 1. single text provided limit greater 1, results can uniquely linked input texts using idx column output. lang Language results. \"default\", returns results local language. bbox object can parsed st_bbox. Results must lie within bbox. osm_tag Character string giving OSM tag filter results . See details. layer Character string giving layer filter results . Can one \"house\", \"street\", \"locality\", \"district\", \"city\", \"county\", \"state\", \"country\", \"\". locbias Numeric vector length 2 object can coerced length-2 numeric vector (e.g. list sfg object). Specifies location bias geocoding format c(lon, lat). Geocoding results biased towards point. radius bias controlled zoom weight place prominence location_bias_scale. locbias_scale Numeric vector specifying importance prominence locbias. higher prominence scale gives weight important places. Possible values range 0 1. Defaults 0.2. zoom Numeric specifying radius locbias effective. Corresponds zoom level OpenStreetMap. exact relation locbias \\(0.25\\text{ km} \\cdot 2^{(18 - \\text{zoom})}\\). Defaults 16. latinize TRUE sanitizes search terms texts converting encoding \"latin1\" using latinize. can helpful search terms contain certain symbols (e.g. fancy quotes) photon handle properly. Defaults TRUE latinize conservative usually cause problems. progress TRUE, shows progress bar longer queries.","code":""},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Unstructured geocoding — geocode","text":"sf dataframe tibble containing following columns: idx: Internal ID specifying index texts parameter. osm_type: Type OSM element, one N (node), W (way), R (relation), P (polygon). osm_id: OpenStreetMap ID matched element. country: Country matched place. city: City matched place. osm_key: OpenStreetMap key. countrycode: ISO2 country code. housenumber: House number, applicable. postcode: Post code, applicable. locality: Locality, applicable. street: Street, applicable. district: District name, applicable. osm_value: OpenStreetMap tag value. name: Place name. type: Layer type described layer parameter. extent: Boundary box match.","code":""},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Unstructured geocoding — geocode","text":"Filtering OpenStreetMap tags follows distinct syntax explained https://github.com/komoot/photon. particular: Include places tag: key:value Exclude places tag: !key:value Include places tag key: key Include places tag value: :value Exclude places tag key: !key Exclude places tag value: :!value","code":""},{"path":"https://jslth.github.io/photon/reference/geocode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Unstructured geocoding — geocode","text":"","code":"# an instance must be mounted first photon <- new_photon()  # geocode a city geocode(\"Berlin\") #> Simple feature collection with 1 feature and 10 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.39894 ymin: 52.51088 xmax: 13.39894 ymax: 52.51088 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 11 #>     idx osm_type osm_id country osm_key countrycode osm_value name  type  extent #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <list> #> 1     1 R         62422 Germany place   DE          city      Berl… city  <dbl>  #> # ℹ 1 more variable: geometry <POINT [°]>  # return more results geocode(\"Berlin\", limit = 10) #> Simple feature collection with 10 features and 18 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -71.18365 ymin: 44.46888 xmax: 13.39894 ymax: 52.52502 #> Geodetic CRS:  WGS 84 #> # A tibble: 10 × 19 #>      idx osm_type    osm_id country city  osm_key countrycode housenumber street #>    <int> <chr>        <dbl> <chr>   <chr> <chr>   <chr>       <chr>       <chr>  #>  1     1 R           6.24e4 Germany NA    place   DE          NA          NA     #>  2     1 N           1.08e9 Germany Berl… histor… DE          NA          Gertr… #>  3     1 W           3.89e7 Germany Berl… leisure DE          3           Olymp… #>  4     1 R           6.65e3 Germany Berl… buildi… DE          6           Unter… #>  5     1 R           3.60e6 Germany Berl… buildi… DE          NA          Einga… #>  6     1 R           1.11e7 Germany Berl… amenity DE          NA          Schwe… #>  7     1 W           9.39e6 Germany Berl… tourism DE          8           Harde… #>  8     1 N           3.86e9 Germany Berl… railway DE          NA          Einga… #>  9     1 R           1.27e6 Germany Berl… amenity DE          NA          Meckl… #> 10     1 R           1.70e5 United… NA    place   US          NA          NA     #> # ℹ 10 more variables: district <chr>, osm_value <chr>, postcode <chr>, #> #   locality <chr>, name <chr>, county <chr>, state <chr>, type <chr>, #> #   extent <list>, geometry <POINT [°]>  # return the results in german geocode(\"Berlin\", limit = 10, lang = \"de\") #> Simple feature collection with 10 features and 18 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -71.18365 ymin: 44.46888 xmax: 13.39894 ymax: 52.52502 #> Geodetic CRS:  WGS 84 #> # A tibble: 10 × 19 #>      idx osm_type    osm_id country city  osm_key countrycode housenumber street #>    <int> <chr>        <dbl> <chr>   <chr> <chr>   <chr>       <chr>       <chr>  #>  1     1 R           6.24e4 Deutsc… NA    place   DE          NA          NA     #>  2     1 N           1.08e9 Deutsc… Berl… histor… DE          NA          Gertr… #>  3     1 W           3.89e7 Deutsc… Berl… leisure DE          3           Olymp… #>  4     1 W           9.39e6 Deutsc… Berl… tourism DE          8           Harde… #>  5     1 R           1.11e7 Deutsc… Berl… amenity DE          NA          Schwe… #>  6     1 R           6.65e3 Deutsc… Berl… buildi… DE          6           Unter… #>  7     1 R           1.27e6 Deutsc… Berl… amenity DE          NA          Meckl… #>  8     1 R           3.60e6 Deutsc… Berl… buildi… DE          NA          Einga… #>  9     1 N           3.86e9 Deutsc… Berl… railway DE          NA          Einga… #> 10     1 R           1.70e5 Verein… NA    place   US          NA          NA     #> # ℹ 10 more variables: district <chr>, osm_value <chr>, postcode <chr>, #> #   locality <chr>, name <chr>, county <chr>, state <chr>, type <chr>, #> #   extent <list>, geometry <POINT [°]>  # limit to cities geocode(\"Berlin\", layer = \"city\") #> Simple feature collection with 1 feature and 10 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.39894 ymin: 52.51088 xmax: 13.39894 ymax: 52.51088 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 11 #>     idx osm_type osm_id country osm_key countrycode osm_value name  type  extent #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <list> #> 1     1 R         62422 Germany place   DE          city      Berl… city  <dbl>  #> # ℹ 1 more variable: geometry <POINT [°]>  # limit to European cities geocode(\"Berlin\", bbox = c(xmin = -71.18, ymin = 44.46, xmax = 13.39, ymax = 52.52)) #> Simple feature collection with 1 feature and 14 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.38142 ymin: 52.51275 xmax: 13.38142 ymax: 52.51275 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 15 #>     idx     osm_id country city   countrycode postcode locality   type  osm_type #>   <int>      <int> <chr>   <chr>  <chr>       <chr>    <chr>      <chr> <chr>    #> 1     1 1078631331 Germany Berlin DE          10117    Dorotheen… house N        #> # ℹ 6 more variables: osm_key <chr>, street <chr>, district <chr>, #> #   osm_value <chr>, name <chr>, geometry <POINT [°]>  # search for museums in berlin geocode(\"Berlin\", osm_tag = \"tourism:museum\") #> Simple feature collection with 1 feature and 14 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.33063 ymin: 52.50659 xmax: 13.33063 ymax: 52.50659 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 15 #>     idx     osm_id country city   countrycode postcode type  osm_type osm_key #>   <int>      <dbl> <chr>   <chr>  <chr>       <chr>    <chr> <chr>    <chr>   #> 1     1 2959465154 Germany Berlin DE          10623    house N        tourism #> # ℹ 6 more variables: housenumber <chr>, street <chr>, district <chr>, #> #   osm_value <chr>, name <chr>, geometry <POINT [°]>  # search for touristic attractions in berlin geocode(\"Berlin\", osm_tag = \"tourism\") #> Simple feature collection with 1 feature and 15 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.33923 ymin: 52.50845 xmax: 13.33923 ymax: 52.50845 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 16 #>     idx  osm_id country city   countrycode postcode type  osm_type osm_key #>   <int>   <int> <chr>   <chr>  <chr>       <chr>    <chr> <chr>    <chr>   #> 1     1 9393789 Germany Berlin DE          10787    house W        tourism #> # ℹ 7 more variables: housenumber <chr>, street <chr>, district <chr>, #> #   osm_value <chr>, name <chr>, extent <list>, geometry <POINT [°]>  # search for anything but tourism geocode(\"Berlin\", osm_tag = \"!tourism\") #> Simple feature collection with 1 feature and 10 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 13.39894 ymin: 52.51088 xmax: 13.39894 ymax: 52.51088 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 11 #>     idx osm_type osm_id country osm_key countrycode osm_value name  type  extent #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <list> #> 1     1 R         62422 Germany place   DE          city      Berl… city  <dbl>  #> # ℹ 1 more variable: geometry <POINT [°]>  # use location biases to match Berlin, IL instead of Berlin, DE geocode(\"Berlin\", locbias = c(-100, 40), locbias_scale = 0.1, zoom = 7, osm_tag = \"place\") #> Simple feature collection with 1 feature and 12 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: -89.90316 ymin: 39.75894 xmax: -89.90316 ymax: 39.75894 #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 13 #>     idx osm_type osm_id country osm_key countrycode osm_value name  county state #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr>  <chr> #> 1     1 R        126290 United… place   US          village   Berl… Sanga… Illi… #> # ℹ 3 more variables: type <chr>, extent <list>, geometry <POINT [°]>  # latinization can help normalize search terms geocode(\"Luatuanu\\u2019u\", latinize = FALSE) # fails #> Simple feature collection with 1 feature and 10 fields (with 1 geometry empty) #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: Inf ymin: Inf xmax: -Inf ymax: -Inf #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 11 #>     idx osm_type osm_id country osm_key countrycode osm_value name  type  extent #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <list> #> 1     1 NA           NA NA      NA      NA          NA        NA    NA    <dbl>  #> # ℹ 1 more variable: geometry <POINT [°]> geocode(\"Luatuanu\\u2019u\", latinize = TRUE)  # works #> Simple feature collection with 1 feature and 10 fields (with 1 geometry empty) #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: Inf ymin: Inf xmax: -Inf ymax: -Inf #> Geodetic CRS:  WGS 84 #> # A tibble: 1 × 11 #>     idx osm_type osm_id country osm_key countrycode osm_value name  type  extent #>   <int> <chr>     <int> <chr>   <chr>   <chr>       <chr>     <chr> <chr> <list> #> 1     1 NA           NA NA      NA      NA          NA        NA    NA    <dbl>  #> # ℹ 1 more variable: geometry <POINT [°]>"},{"path":"https://jslth.github.io/photon/reference/get_instance.html","id":null,"dir":"Reference","previous_headings":"","what":"Photon utilities — get_instance","title":"Photon utilities — get_instance","text":"Utilities manage photon instances. functions operate mounted photon instances can initialized using new_photon. get_instance() retrieves active photon instance. get_photon_url() retrieves photon URL send requests.","code":""},{"path":"https://jslth.github.io/photon/reference/get_instance.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Photon utilities — get_instance","text":"","code":"get_instance()  get_photon_url()"},{"path":"https://jslth.github.io/photon/reference/get_instance.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Photon utilities — get_instance","text":"get_instance returns R6 object class photon. get_photon_url() returns URL string.","code":""},{"path":"https://jslth.github.io/photon/reference/get_instance.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Photon utilities — get_instance","text":"","code":"# make a new photon instance new_photon() #> <photon> #>   Type   : remote #>   Server : https://photon.komoot.io/  # retrieve it from the cache get_instance() #> <photon> #>   Type   : remote #>   Server : https://photon.komoot.io/  # get the server url get_photon_url() #> [1] \"https://photon.komoot.io/\""},{"path":"https://jslth.github.io/photon/reference/has_java.html","id":null,"dir":"Reference","previous_headings":"","what":"Is Java installed? — has_java","title":"Is Java installed? — has_java","text":"Utility function check Java installed right version.","code":""},{"path":"https://jslth.github.io/photon/reference/has_java.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Is Java installed? — has_java","text":"","code":"has_java(version = NULL)"},{"path":"https://jslth.github.io/photon/reference/has_java.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Is Java installed? — has_java","text":"version Character string specifying minimum version Java. installed Java version lower , returns FALSE. NULL, checks kind Java installed system.","code":""},{"path":"https://jslth.github.io/photon/reference/has_java.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Is Java installed? — has_java","text":"logical vector length 1.","code":""},{"path":"https://jslth.github.io/photon/reference/has_java.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Is Java installed? — has_java","text":"","code":"has_java() # Is Java installed? #> [1] TRUE has_java(\"11\") # Is Java > 11 installed? #> [1] TRUE"},{"path":"https://jslth.github.io/photon/reference/latinize.html","id":null,"dir":"Reference","previous_headings":"","what":"Latinization — latinize","title":"Latinization — latinize","text":"Helper tool transliterate various encodings latin. Attempts convert character vector current encoding \"latin1\" - fails - defaults back original term. can useful geocode structured attempting geocode terms containing symbols photon support. Generally, photon supports","code":""},{"path":"https://jslth.github.io/photon/reference/latinize.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Latinization — latinize","text":"","code":"latinize(x, encoding = \"latin1\")"},{"path":"https://jslth.github.io/photon/reference/latinize.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Latinization — latinize","text":"x character vector. encoding Encoding strings x converted . conversion fails, defaults back original encoding. Defaults \"latin1\".","code":""},{"path":"https://jslth.github.io/photon/reference/latinize.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Latinization — latinize","text":"transliterated vector length x. NAs avoided.","code":""},{"path":"https://jslth.github.io/photon/reference/latinize.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Latinization — latinize","text":"","code":"# converts fancy apostrophes to normal ones latinize(\"Luatuanu\\u2019u\") #> [1] \"Luatuanu’u\"  # does nothing latinize(\"Berlin\") #> [1] \"Berlin\"  # also does nothing, although it would fail with `iconv` latinize(\"\\u0391\\u03b8\\u03ae\\u03bd\\u03b1\") #> [1] \"Αθήνα\""},{"path":"https://jslth.github.io/photon/reference/new_photon.html","id":null,"dir":"Reference","previous_headings":"","what":"Initialize a photon instance — new_photon","title":"Initialize a photon instance — new_photon","text":"Initialize photon instance creating new photon object. object stored R session can used perform geocoding requests. Instances can either local remote. Remote instances require nothing URL geocoding requests sent . Local instances require setup photon executable, search index, Java. See photon_local details.","code":""},{"path":"https://jslth.github.io/photon/reference/new_photon.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Initialize a photon instance — new_photon","text":"","code":"new_photon(   path = NULL,   url = NULL,   photon_version = NULL,   country = NULL,   date = \"latest\",   exact = FALSE,   section = NULL,   opensearch = FALSE,   overwrite = FALSE,   quiet = FALSE )"},{"path":"https://jslth.github.io/photon/reference/new_photon.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Initialize a photon instance — new_photon","text":"path Path directory photon executable data stored. Defaults directory \"photon\" current working directory. NULL, remote instance set based url parameter. url URL photon server connect . NULL path also NULL, connects public API https://photon.komoot.io/. photon_version Version photon used. list releases can found : https://github.com/komoot/photon/releases/. Ignored jar given. NULL, uses latest known version. country Character string can identified countryname country. extract country downloaded. NULL, downloads global search index. date Character string date-time object used specify creation date search index. \"latest\", download file tagged \"latest\". character string, value parseable .POSIXct. exact = FALSE, input value compared available dates closest date selected. Otherwise, file selected exactly matches input date. exact TRUE, exactly matches date. Otherwise, selects date lowest difference date parameter. section Subdirectory download server select search index. \"experimental\", selects dump made master version photon. \"archived\", selects dump made older version photon. NULL (arbitrary string), selects dump made current release. Defaults NULL. opensearch TRUE, looks OpenSearch version photon specified path. Opensearch-based photon supports structured geocoding queries currently experimental. Defaults FALSE. See vignette(\"nominatim-import\", package = \"photon\") details. overwrite TRUE, overwrites existing jar files search indices initializing new instance. Defaults FALSE. quiet TRUE, suppresses informative messages.","code":""},{"path":"https://jslth.github.io/photon/reference/new_photon.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Initialize a photon instance — new_photon","text":"R6 object class photon.","code":""},{"path":"https://jslth.github.io/photon/reference/new_photon.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Initialize a photon instance — new_photon","text":"","code":"# connect to public API photon <- new_photon()  # connect to arbitrary server photon <- new_photon(url = \"photonserver.org\")  if (has_java(\"11\")) { # set up a local instance in the current working directory photon <- new_photon(\"photon\", country = \"Monaco\") } #> ℹ openjdk version \"17.0.14\" 2025-01-21 #> ℹ OpenJDK Runtime Environment Temurin-17.0.14+7 (build 17.0.14+7) #> ℹ OpenJDK 64-Bit Server VM Temurin-17.0.14+7 (build 17.0.14+7, mixed mode, #>   sharing) #> ℹ Fetching photon 0.6.2. #> ✔ Successfully downloaded photon 0.6.2. [214ms] #>  #> ℹ Fetching search index for Monaco, created on latest #> ✔ Successfully downloaded search index. [842ms] #>  #> • Version: 0.6.2 #> • Coverage: Monaco #> • Time: 2025-02-22"},{"path":"https://jslth.github.io/photon/reference/photon-package.html","id":null,"dir":"Reference","previous_headings":"","what":"photon: High-Performance Geocoding using 'photon' — photon-package","title":"photon: High-Performance Geocoding using 'photon' — photon-package","text":"Features unstructured, structured reverse geocoding using 'photon' geocoding API https://photon.komoot.io/. Facilitates setup local 'photon' instances enable offline geocoding.","code":""},{"path":"https://jslth.github.io/photon/reference/photon-package.html","id":"terms-of-use","dir":"Reference","previous_headings":"","what":"Terms of use","title":"photon: High-Performance Geocoding using 'photon' — photon-package","text":"https://photon.komoot.io using public API: \"can use API project, please fair - extensive usage throttled. guarantee availability usage might subject change future.\" Note terms apply public API (new_photon()), local instances (e.g. new_photon(path = \".\"))! public API, package sets default 1 request per second (see ).","code":""},{"path":"https://jslth.github.io/photon/reference/photon-package.html","id":"global-options","dir":"Reference","previous_headings":"","what":"Global options","title":"photon: High-Performance Geocoding using 'photon' — photon-package","text":"number global options can set change behavior package functions. include: photon_throttle Rate limit used throttle requests. default, throttle set non-komoot instances. komoot's public API, option defaults 1 request per second. See req_throttle. photon_max_tries Number retries failing request ultimately aborting. Defaults 3. See req_retry. photon_debug Whether echo command external processes GET requests sent photon. Defaults FALSE. photon_movers Whether moving verbosity allowed. FALSE, disables progress bars spinners globally. Overwritten local parameters. Defaults TRUE. option useful non-interactive sessions like RMarkdown. photon_setup_warn Whether convert warnings photon logs R warnings. Many warnings log somewhat useless, can important. Defaults TRUE.","code":""},{"path":[]},{"path":"https://jslth.github.io/photon/reference/photon-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"photon: High-Performance Geocoding using 'photon' — photon-package","text":"Maintainer: Jonas Lieth jonas.lieth@gesis.org (ORCID) [copyright holder]","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":null,"dir":"Reference","previous_headings":"","what":"Local photon instance — photon_local","title":"Local photon instance — photon_local","text":"R6 class used initialize manage local photon instances. can download setup Java, photon executable, necessary ElasticSearch search index. can start, stop, query status photon instance. also basis geocoding requests used retrieve URL geocoding.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"elasticsearch-opensearch","dir":"Reference","previous_headings":"","what":"ElasticSearch / OpenSearch","title":"Local photon instance — photon_local","text":"standard version photon uses ElasticSearch indices geocode. search indices can self-provided importing existing Nominatim database can downloaded Photon download server. Use nominatim = TRUE indicate ElasticSearch indices downloaded. See vignette(\"nominatim-import\", package = \"photon\") details import Nominatim. enable structured geocoding, photon geocoder needs built support OpenSearch. Since photon 0.6.0, OpenSearch jar files included photon releases. OpenSearch indices can also downloaded, support structured geocoding yet. enable structured geocoding, indices imported existing Nominatim database.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"super-class","dir":"Reference","previous_headings":"","what":"Super class","title":"Local photon instance — photon_local","text":"photon::photon -> photon_local","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"public-fields","dir":"Reference","previous_headings":"","what":"Public fields","title":"Local photon instance — photon_local","text":"path Path directory photon instance stored. proc process object handles external process running photon.","code":""},{"path":[]},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"public-methods","dir":"Reference","previous_headings":"","what":"Public methods","title":"Local photon instance — photon_local","text":"photon_local$new() photon_local$mount() photon_local$info() photon_local$purge() photon_local$import() photon_local$start() photon_local$stop() photon_local$download_data() photon_local$remove_data() photon_local$is_running() photon_local$is_ready() photon_local$get_url() photon_local$get_logs() photon_local$clone()","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-new-","dir":"Reference","previous_headings":"","what":"Method new()","title":"Local photon instance — photon_local","text":"Initialize local photon instance. necessary, downloads photon executable, search index, Java.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$new(   path,   photon_version = NULL,   country = NULL,   date = \"latest\",   exact = FALSE,   section = NULL,   opensearch = FALSE,   overwrite = FALSE,   quiet = FALSE )"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"path Path directory photon executable data stored. photon_version Version photon used. list releases can found : https://github.com/komoot/photon/releases/. Ignored jar given. NULL, uses latest known version (Currently: 0.6.2). country Character string can identified countryname country. extract country downloaded. \"planet\", downloads global search index. date Character string date-time object used specify creation date search index. \"latest\", download file tagged \"latest\". character string, value parseable .POSIXct. exact = FALSE, input value compared available dates closest date selected. Otherwise, file selected exactly matches input date. exact TRUE, exactly matches date. Otherwise, selects date lowest difference date parameter. section Subdirectory download server select search index. \"experimental\", selects dump made master version photon. \"archived\", selects dump made older version photon. NULL (arbitrary string), selects dump made current release. Defaults NULL. opensearch TRUE, looks OpenSearch version photon specified path. Opensearch-based photon supports structured geocoding queries built manually using gradle. Hence, downloaded directly. OpenSearch executable found search path, parameter set FALSE. Defaults FALSE. overwrite TRUE, overwrites existing jar files search indices initializing new instance. Defaults FALSE. quiet TRUE, suppresses informative messages.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-mount-","dir":"Reference","previous_headings":"","what":"Method mount()","title":"Local photon instance — photon_local","text":"Attach object session. mounted, geocoding functions send requests URL instance. Manually mounting useful want switch multiple photon instances.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-1","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$mount()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-info-","dir":"Reference","previous_headings":"","what":"Method info()","title":"Local photon instance — photon_local","text":"Retrieve metadata java photon version used well country creation date Eleasticsearch search index.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-2","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$info()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"list containing java version, photon version, applicable, spatial temporal coverage search index.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-purge-","dir":"Reference","previous_headings":"","what":"Method purge()","title":"Local photon instance — photon_local","text":"Kill photon process remove directory. Useful get rid instance entirely.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-3","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$purge(ask = TRUE)"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments-1","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"ask TRUE, asks confirmation purging instance.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns-1","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"NULL, invisibly.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-import-","dir":"Reference","previous_headings":"","what":"Method import()","title":"Local photon instance — photon_local","text":"Import Postgres Nominatim database photon. Runs photon jar file using additional parameter -nominatim-import. Requires running Nominatim database can connected .","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-4","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$import(   host = \"127.0.0.1\",   port = 5432,   database = \"nominatim\",   user = \"nominatim\",   password = \"\",   structured = FALSE,   update = FALSE,   enable_update_api = FALSE,   languages = c(\"en\", \"fr\", \"de\", \"it\"),   countries = NULL,   extra_tags = NULL,   json = FALSE,   timeout = 60,   java_opts = NULL,   photon_opts = NULL )"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments-2","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"host Postgres host database. Defaults \"127.0.0.1\". port Postgres port database. Defaults 5432. database Postgres database name. Defaults \"nominatim\". user Postgres database user. Defaults \"nominatim\". password Postgres database password. Defaults \"\". structured TRUE, enables structured query support importing database. allows usage structured. Structured queries supported OpenSearch version photon. See section \"OpenSearch\" . Defaults FALSE. update TRUE, fetches updates Nominatim database, updating search index without offering API. FALSE, imports database deletes previous index. Defaults FALSE. enable_update_api TRUE, enables additional endpoint /nominatim-update, allows updates Nominatim databases. languages Character vector specifying languages import Nominatim databases. Defaults English, French, German, Italian. countries Character vector specifying country codes import Nominatim database. Defaults country codes. extra_tags Character vector specifying extra OSM tags import Nominatim database. tags used augment geocoding results. Defaults NULL. json TRUE, dumps imported Nominatim database JSON file returns path output file. Defaults FALSE. timeout Time seconds java process aborts. Defaults 60 seconds. java_opts List flags passed java command. photon_opts List flags passed photon jar java command. See cmd_options helper function import external Nominatim databases.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-start-","dir":"Reference","previous_headings":"","what":"Method start()","title":"Local photon instance — photon_local","text":"Start local instance Photon geocoder. Runs jar executable located instance directory.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-5","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$start(   host = \"0.0.0.0\",   port = \"2322\",   ssl = FALSE,   timeout = 60,   java_opts = NULL,   photon_opts = NULL )"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments-3","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"host Character string host name geocoder opened . port Port geocoder listen . ssl TRUE, uses https, otherwise http. Defaults FALSE. timeout Time seconds java process aborts. Defaults 60 seconds. java_opts List flags passed java command. photon_opts List flags passed photon jar java command. See cmd_options helper function import external Nominatim databases.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Local photon instance — photon_local","text":"certain way determine photon instance ready, clear way yet determine photon setup failed. Due , failing setup mostly indicated setup hanging emitting warning. case, setup interrupted manually.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-stop-","dir":"Reference","previous_headings":"","what":"Method stop()","title":"Local photon instance — photon_local","text":"Kills running photon process.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-6","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$stop()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-download-data-","dir":"Reference","previous_headings":"","what":"Method download_data()","title":"Local photon instance — photon_local","text":"Downloads search index using download_searchindex.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-7","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$download_data(   country = NULL,   date = \"latest\",   exact = FALSE,   section = NULL )"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments-4","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"country Character string can identified countryname country. extract country downloaded. NULL, downloads global search index. date Character string date-time object used specify creation date search index. \"latest\", download file tagged \"latest\". character string, value parseable .POSIXct. exact = FALSE, input value compared available dates closest date selected. Otherwise, file selected exactly matches input date. exact TRUE, exactly matches date. Otherwise, selects date lowest difference date parameter. section Subdirectory download server select search index. \"experimental\", selects dump made master version photon. \"archived\", selects dump made older version photon. NULL (arbitrary string), selects dump made current release. Defaults NULL.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-remove-data-","dir":"Reference","previous_headings":"","what":"Method remove_data()","title":"Local photon instance — photon_local","text":"Removes data currently used photon directory. affects unpacked photon_data directory, archived files.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-8","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$remove_data()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-is-running-","dir":"Reference","previous_headings":"","what":"Method is_running()","title":"Local photon instance — photon_local","text":"Checks whether photon instance running ready. difference $is_ready() $is_running() checks specifically running photon instance managed process photon object. words, $is_running() returns TRUE $proc$is_alive() $is_ready() return TRUE. method useful want ensure photon object can control photon server (mostly internal use).","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-9","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$is_running()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns-2","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"logical length 1.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-is-ready-","dir":"Reference","previous_headings":"","what":"Method is_ready()","title":"Local photon instance — photon_local","text":"Checks whether photon instance ready take requests. case photon server returns HTTP 400 sending queryless request. method useful want check whether can send requests.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-10","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$is_ready()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns-3","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"logical length 1.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-get-url-","dir":"Reference","previous_headings":"","what":"Method get_url()","title":"Local photon instance — photon_local","text":"Constructs URL geocoding requests sent .","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-11","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$get_url()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns-4","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"URL send requests .","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-get-logs-","dir":"Reference","previous_headings":"","what":"Method get_logs()","title":"Local photon instance — photon_local","text":"Retrieve logs previous photon runs.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-12","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$get_logs()"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"returns-5","dir":"Reference","previous_headings":"","what":"Returns","title":"Local photon instance — photon_local","text":"Returns dataframe containing run ID (rid, highest number recent run), timestamp (ts), thread, log type (INFO, WARN, ERROR), class trace error message.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"method-clone-","dir":"Reference","previous_headings":"","what":"Method clone()","title":"Local photon instance — photon_local","text":"objects class cloneable method.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"usage-13","dir":"Reference","previous_headings":"","what":"Usage","title":"Local photon instance — photon_local","text":"","code":"photon_local$clone(deep = FALSE)"},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"arguments-5","dir":"Reference","previous_headings":"","what":"Arguments","title":"Local photon instance — photon_local","text":"deep Whether make deep clone.","code":""},{"path":"https://jslth.github.io/photon/reference/photon_local.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Local photon instance — photon_local","text":"","code":"if (has_java(\"11\")) { dir <- file.path(tempdir(), \"photon\")  # start a new instance using a Monaco extract photon <- new_photon(path = dir, country = \"Monaco\")  # start a new instance with an older photon version photon <- new_photon(path = dir, photon_version = \"0.4.1\")} #> ℹ openjdk version \"17.0.14\" 2025-01-21 #> ℹ OpenJDK Runtime Environment Temurin-17.0.14+7 (build 17.0.14+7) #> ℹ OpenJDK 64-Bit Server VM Temurin-17.0.14+7 (build 17.0.14+7, mixed mode, #>   sharing) #> ℹ Fetching photon 0.6.2. #> ✔ Successfully downloaded photon 0.6.2. [157ms] #>  #> ℹ Fetching search index for Monaco, created on latest #> ✔ Successfully downloaded search index. [489ms] #>  #> • Version: 0.6.2 #> • Coverage: Monaco #> • Time: 2025-02-22 #> ℹ openjdk version \"17.0.14\" 2025-01-21 #> ℹ OpenJDK Runtime Environment Temurin-17.0.14+7 (build 17.0.14+7) #> ℹ OpenJDK 64-Bit Server VM Temurin-17.0.14+7 (build 17.0.14+7, mixed mode, #>   sharing) #> ℹ Fetching photon 0.4.1. #> ✔ Successfully downloaded photon 0.4.1. [145ms] #>  #> ℹ A search index already exists at the given path. Download will be skipped #> • Version: 0.4.1 #> • Coverage: Monaco #> • Time: 2025-02-22  if (FALSE) { # \\dontrun{ # import a nominatim database using OpenSearch photon # this example requires the OpenSearch version of photon and a running # Nominatim server. photon <- new_photon(path = dir, opensearch = TRUE) photon$start(photon_options = cmd_options(port = 29146, password = \"pgpass\"))} # }"},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":null,"dir":"Reference","previous_headings":"","what":"Purge Java processes — purge_java","title":"Purge Java processes — purge_java","text":"Kill selected running Java processes. function useful stop Photon instances able kill process objects. aware can also kill Java processes photon application using function!","code":""},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Purge Java processes — purge_java","text":"","code":"purge_java(pids = NULL, ask = TRUE)"},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Purge Java processes — purge_java","text":"pids PIDs kill. PIDs Java processes. NULL, tries kill Java processes. ask TRUE, asks consent killing processes. Defaults TRUE.","code":""},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Purge Java processes — purge_java","text":"integer vector pkill / Taskkill status codes NULL running Java processes found.","code":""},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Purge Java processes — purge_java","text":"list running Java tasks retrieved using ps (Linux MacOS) tasklist (Windows). Tasks killed using pkill (Linux MacOS) Taskkill (Windows).","code":""},{"path":"https://jslth.github.io/photon/reference/purge_java.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Purge Java processes — purge_java","text":"","code":"# NOTE: These examples should only be run interactively or when you are # sure that no other java processes are running simultaneously! if (FALSE) { # \\dontrun{ purge_java() # does nothing if no java processes are running  # start a new photon instance dir <- file.path(tempdir(), \"photon\") photon <- new_photon(dir, country = \"Samoa\") photon$start()  # kill photon using a sledgehammer purge_java()  photon$start()  # kill photon using a scalpel library(ps) p <- ps_handle(photon$proc$get_pid()) pids <- sapply(ps_children(p), ps::ps_pid) purge_java(pids)} # }"},{"path":"https://jslth.github.io/photon/reference/reexports.html","id":null,"dir":"Reference","previous_headings":"","what":"Objects exported from other packages — reexports","title":"Objects exported from other packages — reexports","text":"objects imported packages. Follow links see documentation. processx process, run","code":""},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":null,"dir":"Reference","previous_headings":"","what":"Reverse geocoding — reverse","title":"Reverse geocoding — reverse","text":"Reverse geocode set points retrieve corresponding place names. geocode place name address, see unstructured structured geocoding.","code":""},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Reverse geocoding — reverse","text":"","code":"reverse(   .data,   radius = NULL,   limit = 1,   lang = \"en\",   osm_tag = NULL,   layer = NULL,   locbias = NULL,   locbias_scale = NULL,   zoom = NULL,   distance_sort = TRUE,   progress = interactive() )"},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Reverse geocoding — reverse","text":".data dataframe list names lon lat, sfc sf object containing point geometries. radius Numeric specifying range around points .data used searching. limit Number results return. maximum 50 results can returned single search term. Defaults 1. single text provided limit greater 1, results can uniquely linked input texts using idx column output. lang Language results. \"default\", returns results local language. osm_tag Character string giving OSM tag filter results . See details. layer Character string giving layer filter results . Can one \"house\", \"street\", \"locality\", \"district\", \"city\", \"county\", \"state\", \"country\", \"\". locbias Numeric vector length 2 object can coerced length-2 numeric vector (e.g. list sfg object). Specifies location bias geocoding format c(lon, lat). Geocoding results biased towards point. radius bias controlled zoom weight place prominence location_bias_scale. locbias_scale Numeric vector specifying importance prominence locbias. higher prominence scale gives weight important places. Possible values range 0 1. Defaults 0.2. zoom Numeric specifying radius locbias effective. Corresponds zoom level OpenStreetMap. exact relation locbias \\(0.25\\text{ km} \\cdot 2^{(18 - \\text{zoom})}\\). Defaults 16. distance_sort TRUE, sorts reverse geocoding results based distance input point. Defaults TRUE. progress TRUE, shows progress bar longer queries.","code":""},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Reverse geocoding — reverse","text":"sf dataframe tibble containing following columns: idx: Internal ID specifying index texts parameter. osm_type: Type OSM element, one N (node), W (way), R (relation), P (polygon). osm_id: OpenStreetMap ID matched element. country: Country matched place. city: City matched place. osm_key: OpenStreetMap key. countrycode: ISO2 country code. housenumber: House number, applicable. postcode: Post code, applicable. locality: Locality, applicable. street: Street, applicable. district: District name, applicable. osm_value: OpenStreetMap tag value. name: Place name. type: Layer type described layer parameter. extent: Boundary box match.","code":""},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Reverse geocoding — reverse","text":"Filtering OpenStreetMap tags follows distinct syntax explained https://github.com/komoot/photon. particular: Include places tag: key:value Exclude places tag: !key:value Include places tag key: key Include places tag value: :value Exclude places tag key: !key Exclude places tag value: :!value","code":""},{"path":"https://jslth.github.io/photon/reference/reverse.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Reverse geocoding — reverse","text":"","code":"# an instance must be mounted first photon <- new_photon()  # works with sf objects sf_data <- sf::st_sfc(sf::st_point(c(8, 52)), sf::st_point(c(7, 52))) reverse(sf_data) #> Simple feature collection with 2 features and 17 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 6.995134 ymin: 51.99944 xmax: 7.99941 ymax: 52.00153 #> Geodetic CRS:  WGS 84 #> # A tibble: 2 × 18 #>     idx  osm_id country city  countrycode postcode county type  osm_type osm_key #>   <int>   <dbl> <chr>   <chr> <chr>       <chr>    <chr>  <chr> <chr>    <chr>   #> 1     1  2.80e7 Germany Sass… DE          48336    Kreis… stre… W        highway #> 2     2  4.21e9 Germany Stad… DE          48703    Kreis… house N        place   #> # ℹ 8 more variables: district <chr>, osm_value <chr>, name <chr>, state <chr>, #> #   extent <list>, housenumber <chr>, street <chr>, geometry <POINT [°]>  # ... but also with simple dataframes df_data <- data.frame(lon = c(8, 7), lat = c(52, 52)) reverse(df_data) #> Simple feature collection with 2 features and 17 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 6.995134 ymin: 51.99944 xmax: 7.99941 ymax: 52.00153 #> Geodetic CRS:  WGS 84 #> # A tibble: 2 × 18 #>     idx  osm_id country city  countrycode postcode county type  osm_type osm_key #>   <int>   <dbl> <chr>   <chr> <chr>       <chr>    <chr>  <chr> <chr>    <chr>   #> 1     1  2.80e7 Germany Sass… DE          48336    Kreis… stre… W        highway #> 2     2  4.21e9 Germany Stad… DE          48703    Kreis… house N        place   #> # ℹ 8 more variables: district <chr>, osm_value <chr>, name <chr>, state <chr>, #> #   extent <list>, housenumber <chr>, street <chr>, geometry <POINT [°]>  # limit search radius to 10m reverse(df_data, radius = 10) #> Simple feature collection with 2 features and 17 fields #> Geometry type: POINT #> Dimension:     XY #> Bounding box:  xmin: 6.995134 ymin: 51.99944 xmax: 7.99941 ymax: 52.00153 #> Geodetic CRS:  WGS 84 #> # A tibble: 2 × 18 #>     idx  osm_id country city  countrycode postcode county type  osm_type osm_key #>   <int>   <dbl> <chr>   <chr> <chr>       <chr>    <chr>  <chr> <chr>    <chr>   #> 1     1  2.80e7 Germany Sass… DE          48336    Kreis… stre… W        highway #> 2     2  4.21e9 Germany Stad… DE          48703    Kreis… house N        place   #> # ℹ 8 more variables: district <chr>, osm_value <chr>, name <chr>, state <chr>, #> #   extent <list>, housenumber <chr>, street <chr>, geometry <POINT [°]>"},{"path":"https://jslth.github.io/photon/reference/structured.html","id":null,"dir":"Reference","previous_headings":"","what":"Structured geocoding — structured","title":"Structured geocoding — structured","text":"Geocode set place information street, house number, post code. Structured geocoding generally accurate requires information unstructured geocoding. Note structured geocoding must specifically enabled building Nominatim database. generally available komoot's public API pre-built search indices download_searchindex. See vignette(\"nominatim-import\", package = \"photon\") details. can use helper function has_structured_support() check current API supports structured geocoding.","code":""},{"path":"https://jslth.github.io/photon/reference/structured.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Structured geocoding — structured","text":"","code":"structured(   .data,   limit = 1,   lang = \"en\",   bbox = NULL,   osm_tag = NULL,   layer = NULL,   locbias = NULL,   locbias_scale = NULL,   zoom = NULL,   progress = interactive() )  has_structured_support()"},{"path":"https://jslth.github.io/photon/reference/structured.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Structured geocoding — structured","text":".data Dataframe list containing structured information place geocode. Can contain columns street, housenumber, postcode, city, district, county, state, countrycode. least one columns must present dataframe. Note countries must passed ISO-2 country codes. limit Number results return. maximum 50 results can returned single search term. Defaults 1. single text provided limit greater 1, results can uniquely linked input texts using idx column output. lang Language results. \"default\", returns results local language. bbox object can parsed st_bbox. Results must lie within bbox. osm_tag Character string giving OSM tag filter results . See details. layer Character string giving layer filter results . Can one \"house\", \"street\", \"locality\", \"district\", \"city\", \"county\", \"state\", \"country\", \"\". locbias Numeric vector length 2 object can coerced length-2 numeric vector (e.g. list sfg object). Specifies location bias geocoding format c(lon, lat). Geocoding results biased towards point. radius bias controlled zoom weight place prominence location_bias_scale. locbias_scale Numeric vector specifying importance prominence locbias. higher prominence scale gives weight important places. Possible values range 0 1. Defaults 0.2. zoom Numeric specifying radius locbias effective. Corresponds zoom level OpenStreetMap. exact relation locbias \\(0.25\\text{ km} \\cdot 2^{(18 - \\text{zoom})}\\). Defaults 16. progress TRUE, shows progress bar longer queries.","code":""},{"path":"https://jslth.github.io/photon/reference/structured.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Structured geocoding — structured","text":"sf dataframe tibble containing following columns: idx: Internal ID specifying index texts parameter. osm_type: Type OSM element, one N (node), W (way), R (relation), P (polygon). osm_id: OpenStreetMap ID matched element. country: Country matched place. city: City matched place. osm_key: OpenStreetMap key. countrycode: ISO2 country code. housenumber: House number, applicable. postcode: Post code, applicable. locality: Locality, applicable. street: Street, applicable. district: District name, applicable. osm_value: OpenStreetMap tag value. name: Place name. type: Layer type described layer parameter. extent: Boundary box match.","code":""},{"path":"https://jslth.github.io/photon/reference/structured.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Structured geocoding — structured","text":"Filtering OpenStreetMap tags follows distinct syntax explained https://github.com/komoot/photon. particular: Include places tag: key:value Exclude places tag: !key:value Include places tag key: key Include places tag value: :value Exclude places tag key: !key Exclude places tag value: :!value","code":""},{"path":"https://jslth.github.io/photon/reference/structured.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Structured geocoding — structured","text":"","code":"if (FALSE) { # \\dontrun{ # structured() requires an OpenSearch instance with structured support # the following code will not work off the shelf # refer to vignette(\"nominatim-import\") for details dir <- file.path(tempdir(), \"photon\") photon <- new_photon(dir, opensearch = TRUE) photon$import(password = \"psql_password\", structured = TRUE) photon$start()  # check if structured() is supported has_structured_support()  # structured() works on dataframes containing structurized data place_data <- data.frame(   housenumber = c(NA, \"77C\", NA),   street = c(\"Falealilli Cross Island Road\", \"Main Beach Road\", \"Le Mafa Pass Road\"),   state = c(\"Tuamasaga\", \"Tuamasaga\", \"Atua\") ) structured(place_data, limit = 1)  # countries must be specified as iso2 country codes structured(data.frame(countrycode = \"ws\"))  # traditional parameters from geocode() can also be used but are much more niche structured(data.frame(city = \"Apia\"), layer = \"house\") # matches nothing  # structured geocoding can discern small differences in places safune <- data.frame(   city = c(\"Safune\", \"Safune\"),   state = c(\"Gaga'ifomauga\", \"Tuamasaga\") ) structured(safune, limit = 1) } # }"},{"path":"https://jslth.github.io/photon/news/index.html","id":"photon-035","dir":"Changelog","previous_headings":"","what":"photon 0.3.5","title":"photon 0.3.5","text":"Set limit = 1 default (#2) Increment photon version number Document lang = \"default\" (#8) Allow osm_tags layer arguments take vectors length > 1 (#7) Fix typos old info documentation (#4) Add current date metadata search index tagged “latest” (#5) Fix typo range assertion (#9) Add details HTTP error messages (#6) Improve performance querying duplicates (#10) Always keep number rows original dataset (#3) Fix broken ps command newer Linux versions Made setups stable splitting logs (#11, #12) Handle NA argument input elegantly Added optional latinization Renamed consent argument purge_java() ask","code":""},{"path":"https://jslth.github.io/photon/news/index.html","id":"photon-031","dir":"Changelog","previous_headings":"","what":"photon 0.3.1","title":"photon 0.3.1","text":"CRAN release: 2024-11-11 Initial CRAN submission.","code":""}]
